{% extends "clound_base.html" %}
{% load i18n %}
{% load static %}
{% load staticfiles %}

{% block title %}设置中心-{{server.servername}}{% endblock %}

{% block  script %}

    $(document).ready(function()
    {
        <!-- 加载设置内容 -->
        <!--第一阶段-->
        $.get("../installsetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'install'}, function(ret)
        {
            loadret(ret);
            <!--第二阶段-->
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'all'}, function(ret)
            {
                openOrCloseAlarmType('type_0_1');
                openOrCloseAlarmType('type_registry_1');
                loadret(ret);
            })
        })


    });

    var highsetindex = 0;

    <!--增加新的规则-->
    function addrule(feature)
    {
        var titleid = feature + 'titleid';
        if(feature == 'file_prot_')
        {
            document.getElementById(titleid).innerHTML='增加文件保护规则';

            document.getElementById('file_prot_rule_name').value = '';
            document.getElementById('file_prot_rule_path').value = '';
            document.getElementById('file_prot_id').value = '';

            <!--监控类型为目录-->
            var ruletypeobj=document.getElementsByName('file_prot_ruletype');
            ruletypeobj[0].checked = false;
            ruletypeobj[1].checked = false;

            <!-- 禁止操作的checkbox的勾选内容 -->
            var obj=document.getElementsByName('file_prot_trail');
            var forbidaction='';
            for(var i=0; i<obj.length; i++)
            {
                obj[i].checked = false;
            }

            $('#file_prot_forbidfile').removeClass("on");
            document.getElementById('file_prot_rule_content_1').value = '';
            $('#file_prot_allowextenname').removeClass("on");
            document.getElementById('file_prot_rule_content_2').value = '';
            $('#file_prot_forbidextenname').removeClass("on");
            document.getElementById('file_prot_rule_content_3').value = '';
            $('#file_prot_processwhitelist').removeClass("on");
            document.getElementById('file_prot_rule_content_4').value = '';
            $('#file_prot_processblacklist').removeClass("on");
            document.getElementById('file_prot_rule_content_5').value = '';
            $('#file_prot_allowfile').addClass("on");
            $(".tab_box > div").eq(0).show().siblings().hide();
            document.getElementById('file_prot_rule_content_0').value = '';
            highsetindex = 0;
        }
        else if (feature == 'registry_prot_')
        {
            document.getElementById(titleid).innerHTML='增加注册表保护规则';

            document.getElementById('registry_prot_rule_name').value = '';
            document.getElementById('registry_prot_rule_path').value = '';
            document.getElementById('registry_prot_id').value = '';

            <!--监控类型为目录-->
            var ruletypeobj=document.getElementsByName('registry_prot_ruletype');
            ruletypeobj[0].checked = false;
            ruletypeobj[1].checked = false;

            <!-- 禁止操作的checkbox的勾选内容 -->
            var obj=document.getElementsByName('registry_prot_trail');
            var forbidaction='';
            for(var i=0; i<obj.length; i++)
            {
                obj[i].checked = false;
            }

            $('#registry_prot_processwhitelist').addClass("on");
            document.getElementById('registry_prot_rule_content_0').value = '';
            $('#registry_prot_processblacklist').removeClass("on");
            $(".tab_box > div").eq(0).show().siblings().hide();
            document.getElementById('registry_prot_rule_content_1').value = '';
            highsetindex = 0;
        }
    }

    <!--新增进程行为控制的时候，清空内容-->
    function adoprocess()
    {
        document.getElementById('process_behavior_rule_path').value = '';
        document.getElementById('process_behavior_id').value = '';

        <!-- 禁止操作的checkbox的勾选内容 -->
        var obj=document.getElementsByName('process_behavior_trail');
        var forbidaction='';
        for(var i=0; i<obj.length; i++)
        {
            obj[i].checked = false;
        }
    }

    var bisaddrule = true;    

    <!--修改规则-->
    function changerule(feature)
    {
        var selectid = feature + 'selectrule';
        var obj=document.getElementsByName(selectid);
        var selectruleid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectruleid += obj[i].value;
            }
        }

        if(checknum != 1 )
        {
            alert("请勾选需要修改的规则，不支持勾选多条规则！");
            return;
        }

        var titleid = feature + 'titleid';
        if(feature == 'file_prot_')
        {
            document.getElementById(titleid).innerHTML='修改文件保护规则';
            ShowDiv('file_prot_protect_add','fade','file_prot');
        }
        else if (feature == 'registry_prot_')
        {
            document.getElementById(titleid).innerHTML='修改注册表保护规则';
            ShowDiv('registry_prot_protect_add','fade','registry_prot');
        }
        
        bisaddrule = false;            

        removeclass(feature);
        {% for userrule in file_prot_userrules %}
            if ( '{{userrule.id}}' == selectruleid )
            {
                var rule_pathtmp = '{{userrule.rulepath}}';
                var rule_path = rule_pathtmp.replace(/\\/g, '\\\\');

                document.getElementById('file_prot_rule_name').value = '{{userrule.rulename}}';
                document.getElementById('file_prot_rule_path').value = rule_path;
                document.getElementById('file_prot_id').value = '{{userrule.rulename}}';

                <!--监控类型为目录-->
                var ruletypeobj=document.getElementsByName('file_prot_ruletype');
                var urletype = '{{userrule.fileprottype}}';


                if(urletype & 1)
                {
                    ruletypeobj[0].checked = true;
                }
                if(urletype & 2)
                {
                    ruletypeobj[1].checked = true;
                }

                <!-- 禁止操作的checkbox的勾选内容 -->
                var obj=document.getElementsByName('file_prot_trail');
                var forbidaction='';
                for(var i=0; i<obj.length; i++)
                {
                    obj[i].checked = false;
                }

                var forbidaction = '{{userrule.forbidaction}}';
                var forbidarray = new Array();
                forbidarray = forbidaction.split(";");
                if(forbidarray.contains('check_no_del'))
                {
                    var el = document.getElementById('file_prot_nodel');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_run'))
                {
                    var el = document.getElementById('file_prot_norun');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_create'))
                {
                    var el = document.getElementById('file_prot_nocreate');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_read'))
                {
                    var el = document.getElementById('file_prot_noread');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_write'))
                {
                    var el = document.getElementById('file_prot_nowrite');
                    el.checked = true;
                }

                <!--高级设置-->
                var rulsel = {{userrule.highindex}};
                highsetindex = rulsel;
                if(0 == rulsel)
                {
                    $('#file_prot_allowfile').addClass("on");
                    $(".tab_box > div").eq(0).show().siblings().hide();
                }
                else if(1 == rulsel)
                {
                    $('#file_prot_forbidfile').addClass("on");
                    $(".tab_box > div").eq(1).show().siblings().hide();
                }
                else if(2 == rulsel)
                {
                    $('#file_prot_allowextenname').addClass("on");
                    $(".tab_box > div").eq(2).show().siblings().hide();
                }
                else if(3 == rulsel)
                {
                    $('#file_prot_forbidextenname').addClass("on");
                    $(".tab_box > div").eq(3).show().siblings().hide();
                }
                else if(4 == rulsel)
                {
                    $('#file_prot_processwhitelist').addClass("on");
                    $(".tab_box > div").eq(4).show().siblings().hide();
                }
                else if(5 == rulsel)
                {
                    $('#file_prot_processblacklist').addClass("on");
                    $(".tab_box > div").eq(5).show().siblings().hide();
                }

                document.getElementById('file_prot_rule_content_0').value = '{{userrule.allowFiles}}';
                document.getElementById('file_prot_rule_content_1').value = '{{userrule.refuseFiles}}';
                document.getElementById('file_prot_rule_content_2').value = '{{userrule.allowExts}}';
                document.getElementById('file_prot_rule_content_3').value = '{{userrule.refuseExts}}';
                document.getElementById('file_prot_rule_content_4').value = '{{userrule.allowProcess}}';
                document.getElementById('file_prot_rule_content_5').value = '{{userrule.refuseProcess}}';
            }
        {% endfor %}
        
        {% for userrule in registry_prot_userrules %}
            if ( '{{userrule.id}}' == selectruleid )
            {
                var rule_pathtmp = '{{userrule.rulepath}}';
                var rule_path = rule_pathtmp.replace(/\\/g, '\\\\');

                document.getElementById('registry_prot_rule_name').value = '{{userrule.rulename}}';
                document.getElementById('registry_prot_rule_path').value = rule_path;
                document.getElementById('registry_prot_id').value = '{{userrule.rulename}}';

                <!--注册表保护的监控类型，为注册表值还是注册表项-->
                var ruletypeobj=document.getElementsByName('registry_prot_ruletype');
                var urletype = '{{userrule.fileprottype}}';

                if(urletype & 1)
                {
                    ruletypeobj[0].checked = true;
                }
                if(urletype & 2)
                {
                    ruletypeobj[1].checked = true;
                }


                <!-- 禁止操作的checkbox的勾选内容 -->
                var obj=document.getElementsByName('registry_prot_trail');
                var forbidaction='';
                for(var i=0; i<obj.length; i++)
                {
                    obj[i].checked = false;
                }

                var forbidaction = '{{userrule.forbidaction}}';
                var forbidarray = new Array();
                forbidarray = forbidaction.split(";");
                if(forbidarray.contains('check_no_del'))
                {
                    var el = document.getElementById('registry_prot_nodel');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_create'))
                {
                    var el = document.getElementById('registry_prot_nocreate');
                    el.checked = true;
                }
                if(forbidarray.contains('check_no_write'))
                {
                    var el = document.getElementById('registry_prot_nowrite');
                    el.checked = true;
                }

                <!--高级设置-->
                var rulsel = {{userrule.highindex}};
                highsetindex = rulsel;
                if(0 == rulsel)
                {
                    $('#registry_prot_processwhitelist').addClass("on");
                    $("#registry_prot_div > div").eq(0).show().siblings().hide();
                }
                else if(1 == rulsel)
                {
                    $('#registry_prot_processblacklist').addClass("on");
                    $("#registry_prot_div > div").eq(1).show().siblings().hide();
                }

                document.getElementById('registry_prot_rule_content_0').value = '{{userrule.allowProcess}}';
                document.getElementById('registry_prot_rule_content_1').value = '{{userrule.refuseProcess}}';

            }
        {% endfor %}
    }

    <!--删除勾选规则-->
    function delselectrule(feature)
    {
        var selectinputid = feature + 'selectrule';
        var obj=document.getElementsByName(selectinputid);
        var selectruleid='';

        var selectedrule= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectruleid += obj[i].value + ';';

                {% for userrule in file_prot_userrules %}
                    if(obj[i].value == {{userrule.id}})
                    {
                        if('[' != selectedrule)
                        {
                            selectedrule += ',';
                        }
                        selectedrule += '"{{userrule.rulename}}"';
                    }
                {% endfor %}

                {% for userrule in registry_prot_userrules %}
                    if(obj[i].value == {{userrule.id}})
                    {
                        if('[' != selectedrule)
                        {
                            selectedrule += ',';
                        }
                        selectedrule += '"{{userrule.rulename}}"';
                    }
                {% endfor %}
            }
        }
        selectedrule += ']';

        var featuremode = '';
        if( 'file_prot_' == feature)
        {
            featuremode = 'fileProtect';
        }
        else if ( 'registry_prot_' == feature)
        {
            featuremode = 'registerProtect';
        }

        if('' == selectruleid)
        {
            alert('至少勾选一条规则！');
            return;
        }


        $.get("../delrule",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectruleid':selectruleid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除规则成功');
                var msg='{"method": "{0}","param": {1},"type": "delete"}'.format(featuremode,selectedrule);
				EncryptMsg(msg,true);
            }
            else
            {
                alert('删除规则失败');
            }
        }
        )
    }

    <!--判断IP是否符合格式-->
    function checkisIp(ip)
    {
		<!-- 正则表达式 -->
        var re=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/;
        if(re.test(ip))
        {
            if( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256)
            {
                return ip;
            }
        }
		return '';        
    }

	<!-- 判断Mac地址是否符合格式 -->
	function checkisMac(mac)
	{
		var temp = /[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}/;
		if (!temp.test(mac))
		{
			 return false;
		}
		return true;
	}

    <!--判断规则名中只能有中文、数字和引文-->
    function checkUseRuelrname(str)
    {
        <!-- 正则表达式 -->
        var reg = new RegExp("^[A-Za-z0-9\u4e00-\u9fa5]+$");
        var status = reg.test(str);
        <!-- 判断输入框中有内容 -->
        if(!status)
        {
            alert("请输入中文、数字或英文！");
        }
        return status;
    }

    <!--判断规则名中只能有中文、数字和引文-->
    function checkPath(str)
    {
        //正则表达式
        var status = /^[A-Za-z]{1}:\/[\w\/]*/.test(str);
        if(!status)
        {
            alert('请输入正确的路径格式！');
        }
        return status;
    }

    function checkHighSet(str)
    {
        if('' == str)
        {
            return false;
        }

        var highsetarray = str.split("|");
        if(highsetarray.length>20)
        {
            alert('高级设置：'+ str +'超出20个名称的限定长度！');
            return true;
        }

        for(i=0,len=highsetarray.length;i<len;i++)
        {
            var highset = highsetarray[i];
            if(highset.length>63)
            {
                alert('高级设置：'+ highset +'超出63个字符的限定长度！');
                return true;
            }
        }
        return false;
    }

    var ruleSel = 0;
    
    <!-- 保存修改用户的自定义规则 -->
    function saveuserrule(feature)
    {
        var rulenameid = feature + 'rule_name';
        var rulepathid = feature + 'rule_path';
        var rulecontentid = feature + 'rule_content_';
        
        var newrulename = document.getElementById(rulenameid).value;
        if('' == newrulename)
        {
            alert('请输入规则名称！');
            return;
        }
        else
        {
            if(!checkUseRuelrname(newrulename))
            {
                return;
            }
        }

        var newrulepath = document.getElementById(rulepathid).value;
        if('' == newrulepath)
        {
            alert('请输入监控路径！');
            return;
        }
        else
        {
            if('file_prot' == feature || 'file_prot_' == feature)
            {
                <!--对路径的正则匹配-->
                if(!checkPath(newrulepath))
                {
                    return;
                }
            }
            else
            {
                if(0 != newrulepath.indexOf('HKEY_CLASSES_ROOT') && 0 != newrulepath.indexOf('HKEY_CURRENT_USER')&& 0 != newrulepath.indexOf('HKEY_LOCAL_MACHINE')&& 0 != newrulepath.indexOf('HKEY_USERS')&& 0 != newrulepath.indexOf('HKEY_CURRENT_CONFIG'))
                {
                    alert('请输入正确注册表路径！');
                    return;
                }
            }
        }
        
        <!-- 获取select选中的值 -->
        var ruletypename = feature + 'ruletype';
        var ruletypeobj=document.getElementsByName(ruletypename);
        var ruletype= 0;
        for(var i=0; i<ruletypeobj.length; i++)
        {
            if(ruletypeobj[i].checked)
            {
                ruletype += Math.pow(2,i);
            }
        }
        if(0 == ruletype)
        {
            alert('请至少选择一种监控类型！');
            return;
        }
            
        <!-- 禁止操作的checkbox的勾选内容 -->
        var trailid = feature + 'trail';
        var obj=document.getElementsByName(trailid);         
        var forbidaction=''; 
        var forbidOpt= 0;
        for(var i=0; i<obj.length; i++)
        { 
            if(obj[i].checked) 
            {
                forbidaction+=obj[i].value+';';
                forbidOpt += Math.pow(2,i);
            } 
        }
        if(0 == forbidOpt)
        {
            alert('请至少选择一种禁止文件操作！');
            return;
        }
    
        feature = feature.substr(0, feature.length - 1);

        var oldrulename = '';
        if( 'file_prot' == feature)
        {
            oldrulename= document.getElementById('file_prot_id').value;

            var allowExts =  document.getElementById('file_prot_rule_content_2').value;
            var allowFiles =  document.getElementById('file_prot_rule_content_0').value;
            var allowProcess =  document.getElementById('file_prot_rule_content_4').value;
            var refuseExts =  document.getElementById('file_prot_rule_content_3').value;
            var refuseFiles =  document.getElementById('file_prot_rule_content_1').value;
            var refuseProcess =  document.getElementById('file_prot_rule_content_5').value;
        }
        else if ( 'registry_prot' == feature)
        {
            oldrulename= document.getElementById('registry_prot_id').value;
            var allowExts = '';
            var allowFiles = '';
            var refuseExts = '';
            var refuseFiles = '';
            var allowProcess =  document.getElementById('registry_prot_rule_content_0').value;
            var refuseProcess =  document.getElementById('registry_prot_rule_content_1').value;
        }

        if(checkHighSet(allowExts) || checkHighSet(allowFiles) || checkHighSet(refuseExts) || checkHighSet(refuseFiles) || checkHighSet(allowProcess) || checkHighSet(refuseProcess))
        {
            console.log("高级设置长度超长！");
            return;
        }

        var featuremode = feature;
        var ruleSel = Math.pow(2,highsetindex);
        $.get("../addrule",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','feature':feature,'oldrulename':oldrulename,'newrulename':newrulename,'newrulepath':newrulepath,'fileprottype':ruletype,'forbidaction':forbidaction,'allowExts':allowExts,'allowFiles':allowFiles,'allowProcess':allowProcess,'refuseExts':refuseExts,'refuseFiles':refuseFiles,'refuseProcess':refuseProcess,'highsetindex':highsetindex}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存规则成功');

                if( 'file_prot' == featuremode)
                {
                    method = 'fileProtect';
                }
                else if ( 'registry_prot' == featuremode)
                {
                    method = 'registerProtect';
                   }

                if('' != oldrulename)
                {
                    type='modify';
                }
                else
                {
                    type='add';
                }


                var msg = '{"method":"{method}","param":[{"allowExts":"{allowExts}","allowFiles":"{allowFiles}","allowProcess":"{allowProcess}","forbidOpt":{forbidOpt},"path":"{path}","refuseExts":"{refuseExts}","refuseFiles":"{refuseFiles}","refuseProcess":"{refuseProcess}","oldRuleName":"{oldruleName}","ruleName":"{ruleName}","ruleSel":{ruleSel},"ruleType":{ruletype},"status": false}],"type":"{type}"}'.format({ruleSel:ruleSel, path:newrulepath,ruleName:newrulename,oldruleName:oldrulename,ruletype:ruletype,forbidOpt:forbidOpt,allowFiles:allowFiles,refuseFiles:refuseFiles,allowExts:allowExts,refuseExts:refuseExts,allowProcess:allowProcess,refuseProcess:refuseProcess,method:method,type:type});
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存规则失败');
            }
        }
        )
        
    }

    <!--修改用户的重要进程信息-->
    function changeprocess()
    {
        var obj=document.getElementsByName('process_behavior_selectrule');
        var selectruleid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectruleid += obj[i].value;
            }
        }

        if(checknum != 1 )
        {
            alert("请勾选需要修改的进程，不支持勾选多条规则！");
            return;
        }


        document.getElementById('process_behavior_titleid').innerHTML='修改进程行为控制规则';
        ShowDiv('process_behavior_protect_add','fade','process_behavior');

        {% for importprocess in importprocesses %}
            if ( '{{importprocess.id}}' == selectruleid )
            {
                var processpathtmp = '{{importprocess.processpath}}';
                var processpath = processpathtmp.replace(/\\/g, '\\\\');

                document.getElementById('process_behavior_rule_path').value = processpath;
                document.getElementById('process_behavior_id').value = processpath;

                <!-- 禁止操作的checkbox的勾选内容 -->               

                var ruleSel = {{importprocess.ruleSel}};
                if(ruleSel & 256)
                {
                    document.getElementById('process_behavior_noexternalTCPlink').checked = true;
                }
                if(ruleSel & 512)
                {
                    document.getElementById('process_behavior_notooutTCPlink').checked = true;
                }
                if(ruleSel & 1024)
                {
                    document.getElementById('process_behavior_noacceptUDP').checked = true;
                }
                if(ruleSel & 2048)
                {
                    document.getElementById('process_behavior_nosendUDP').checked = true;
                }
                if(ruleSel & 16)
                {
                    document.getElementById('process_behavior_nonewexe').checked = true;
                }
                if(ruleSel & 32)
                {
                    document.getElementById('process_behavior_nonewdll').checked = true;
                }
                if(ruleSel & 64)
                {
                    document.getElementById('process_behavior_nochangeexe').checked = true;
                }
                if(ruleSel & 128)
                {
                    document.getElementById('process_behavior_nochangedll').checked = true;
                }
				if(ruleSel & 1)
                {
                    document.getElementById('process_behavior_nodrive').checked = true;
                }
                if(ruleSel & 2)
                {
                    document.getElementById('process_behavior_noinject').checked = true;
                }
                if(ruleSel & 4)
                {
                    document.getElementById('process_behavior_norestart').checked = true;
                }
                if(ruleSel & 4096)
                {
                    document.getElementById('process_behavior_noglobalhool').checked = true;
                }
				if(ruleSel & 8192)
                {
                    document.getElementById('process_behavior_nosendwmclose').checked = true;
                }
                if(ruleSel & 65536)
                {
                    document.getElementById('process_behavior_noaddtaskplan').checked = true;
                }
                if(ruleSel & 32768)
                {
                    document.getElementById('process_behavior_noserviceprotect').checked = true;
                }
                if(ruleSel & 16384)
                {
                    document.getElementById('process_behavior_nosysaccountprotect').checked = true;
                }
                if(ruleSel & 8)
                {
                    document.getElementById('process_behavior_nochildprocess').checked = true;
                }
                             
            }
        {% endfor %}
    }

    $(document).ready(function()
    {
        {% for importprocess in importprocesses %}
            $("#process_behavior_solution_stop_{{importprocess.id}}").click(function()
            {
                $.get("../processsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','process_id':'{{importprocess.id}}','obj':'stop'}, function(ret)
                {
                    var actionType = 0;
                    var obj=document.getElementById('process_behavior_solution_stop_{{importprocess.id}}'); 
                    if(obj.checked)
                    {
                        actionType += Math.pow(2,0);
                    }
                    var obj=document.getElementById('process_behavior_solution_record_{{importprocess.id}}'); 
                    if(obj.checked)
                    {
                        actionType += Math.pow(2,1);
                    }

                    var process_path = '{{importprocess.processpath}}';
                    var msg = '{"method":"process","param":[{"actionType":{actionType},"path":"{process_path}"}],"type":"modifyStrategy"}'.format({actionType:actionType,process_path:process_path});
                    EncryptMsg(msg);
                })
            });
            
            $("#process_behavior_solution_record_{{importprocess.id}}").click(function()
            {
                $.get("../processsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','process_id':'{{importprocess.id}}','obj':'record'}, function(ret)
                {
                    var actionType = 0;
                    var obj=document.getElementById('process_behavior_solution_stop_{{importprocess.id}}'); 
                    if(obj.checked)
                    {
                        actionType += Math.pow(2,0);
                    }
                    var obj=document.getElementById('process_behavior_solution_record_{{importprocess.id}}'); 
                    if(obj.checked)
                    {
                        actionType += Math.pow(2,1);
                    }
                    
                    var process_path = '{{importprocess.processpath}}';
                    var msg = '{"method":"process","param":[{"actionType":{actionType},"path":"{process_path}"}],"type":"modifyStrategy"}'.format({actionType:actionType,process_path:process_path});
                    EncryptMsg(msg);
                })
            });
        {% endfor %}
        
        
        {% for app in apps %}
            $("#app_control_solution_stop_{{app.id}}").click(function()
            {
                $.get("../appcontrolsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','app_id':'{{app.id}}','obj':'stop'}, function(ret)
                {
                    ;
                })
            });
            
            $("#app_control_solution_record_{{app.id}}").click(function()
            {
                $.get("../appcontrolsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','app_id':'{{app.id}}','obj':'record'}, function(ret)
                {
                    ;
                })
            });
        {% endfor %}
        
        {% for device in devices %}
            $("#outside_control_solution_stop_{{device.id}}").click(function()
            {
                $.get("../outsidecontrolsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','device_id':'{{device.id}}','obj':'stop'}, function(ret)
                {
                    ;
                })
            });
            
            $("#outside_control_solution_record_{{device.id}}").click(function()
            {
                $.get("../outsidecontrolsolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','device_id':'{{device.id}}','obj':'record'}, function(ret)
                {
                    ;
                })
            });
        {% endfor %}
        
        
        {% for port in ports %}
            $("#port_security_solution_stop_{{port.id}}").click(function()
            {
                $.get("../portsecuritysolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','portid':'{{port.id}}','obj':'stop'}, function(ret)
                {
                    ;
                })
            });
            
            $("#port_security_solution_record_{{port.id}}").click(function()
            {
                $.get("../portsecuritysolution",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','portid':'{{port.id}}','obj':'record'}, function(ret)
                {
                    ;
                })
            });
        {% endfor %}
        
    });


    <!-- 保存进程行为控制中添加/修改的进程信息 -->
    function saveprocess()
    {
        var process_path = document.getElementById('process_behavior_rule_path').value;
        if('' == process_path)
        {
            alert('请输入程序路径！');
            return;
        }
        {
            if(!checkPath(process_path))
            {
                return;
            }
        }

        var patharray = process_path.split('/');
        var process_name = patharray[patharray.length-1];
        var obj=document.getElementsByName('process_behavior_trail');
        var ruleSel= 0;
        for(var i=0; i<obj.length; i++)
        { 
            if(obj[i].checked) 
            {
                ruleSel += Math.pow(2,i);
            } 
        }

        var oldprocesspath= document.getElementById('process_behavior_id').value;        
        $.get("../saveprocess",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','oldprocesspath':oldprocesspath,'process_name':process_name,'process_path':process_path,'ruleSel':ruleSel}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存进程成功');
                if('' == oldprocesspath)
                {
                    type = 'add';
                }
                else
                {
                    type = 'modify';
                }
                
                var msg = '{"method":"process","param":[{"actionType":0,"ruleSel":{ruleSel},"path":"{process_path}","oldPath":"{oldProcessPath}"}],"type":"{type}"}'.format({process_path:process_path,oldProcessPath:oldprocesspath,ruleSel:ruleSel,type:type});
                EncryptMsg(msg,true);
            }
            else
            {
                alert('进程路径：'+ process_path +'，保存进程失败');
            }
        }
        )
    }
    
    <!--删除勾选进程-->
    function delselectprocess()
    {
        var obj=document.getElementsByName('process_behavior_selectrule');
        var selectprocessid='';

        var selectedprocess= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectprocessid += obj[i].value + ';';

                {% for importprocess in importprocesses %}
                    if(obj[i].value == {{importprocess.id}})
                    {
                        if('[' != selectedprocess)
                        {
                            selectedprocess += ',';
                        }
                        selectedprocess += '"{{importprocess.processpath}}"';
                    }
                {% endfor %}
            }
        }
        selectedprocess += ']';

        if('' == selectprocessid)
        {
            alert('至少勾选一条进程!');
            return;
        }

        $.get("../delprocess",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectprocessid':selectprocessid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除受控进程成功');
                var msg='{"method": "process","param": {0},"type": "delete"}'.format(selectedprocess);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除受控进程失败');
            }
        }
        )
    }
	
	function RemoteLoginSet()
    {
        <!-- document.getElementById('city-picker3').value = '{{server.commonlogincitya}}' -->
		document.getElementById('city-picker3').placeholder = '{{server.commonlogincitya}}'
        <!-- document.getElementById('city-picker32').value = '{{server.commonlogincityab}' -->
		document.getElementById('city-picker32').placeholder = '{{server.commonlogincityb}}'
		
        var remotelogintype = {{server.remoteloginnotice}};
        var obj=document.getElementsByName('remotelogin');
        if(remotelogintype & 1)
        {
            obj[0].checked = true;
        }
        if(remotelogintype & 2)
        {
            obj[1].checked = true;
        }
    }

    <!-- 保存IP认证白名单 -->
    function SaveIpWhitelist()
    {
        var whitelist = document.getElementById('login_protIp_whitelist').value; 
        var remark = document.getElementById('login_protIp_remark').value;
        var whitelistid = document.getElementById('login_protIp_id').value;

        if('' == whitelist)
        {
            alert('白名单内容不能为空！');
            return;
        }

        var type = '';
        var status = false;
        if('' != whitelistid)
        {
            type = 'modify';
        }
        else
        {
            type = 'add';
        }

        $.get("../savewhitelist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','authmethod':'COMPUTER_IP','whitelistid':whitelistid,'whitelist':whitelist,'remark':remark}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存白名单成功');
                var msg='{"method": "LogoInProtect","param": [{"Id":"{0}","Des":"{1}","Type":0,"Status":{2},"OldId":"{3}"}],"type":"{4}"}'.format(whitelist,remark,status,whitelistid,type);
				EncryptMsg(msg,true);
            }
            else
            {
                alert('保存白名单失败');
            }
        }
        )
    }
    
    <!-- 保存计算机名认证白名单 -->
    function SaveNameWhitelist()
    {
        var whitelist = document.getElementById('login_protName_whitelist').value; 
        var remark = document.getElementById('login_protName_remark').value;
        var whitelistid = document.getElementById('login_protName_id').value;
		
		var type = '';
        var status = false;
        if('' != whitelistid)
        {
            type = 'modify';
        }
        else
        {
            type = 'add';
        }
        $.get("../savewhitelist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','authmethod':'COMPUTER_NAME','whitelistid':whitelistid,'whitelist':whitelist,'remark':remark}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存白名单成功');
				var msg='{"method": "LogoInProtect","param": [{"Id":"{0}","Des":"{1}","OldId":"{2}","Type":1,"Status":{3}}],"type":"{4}"}'.format(whitelist,remark,whitelistid,status,type);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存白名单失败');
            }
        }
        )
    }
    
    <!-- 修改勾选的ip认证的白名单 -->
    function changeipwhitelist()
    {
        var obj=document.getElementsByName('login_protip_selectrule');
        var selectwhitelistid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectwhitelistid += obj[i].value;
            }
        }
        
        if(checknum != 1 )
        {
            alert("请勾选需要修改的白名单，不支持勾选多条规则！");
            return;
        }        
        
        ShowDiv('login_protIp_protect_add','fade','whitelist_access_control');
        {% for whitelist in whitelists %}
            if ( '{{whitelist.whitelist}}' == selectwhitelistid )
            {                    
                document.getElementById('login_protIp_whitelist').value='{{whitelist.whitelist}}';
                document.getElementById('login_protIp_remark').value='{{whitelist.remark}}';
                document.getElementById('login_protIp_id').value='{{whitelist.whitelist}}';
            }
        {% endfor %}    
        
    }
    
    <!-- 修改勾选的计算机认证的白名单 -->
    function changenamewhitelist()
    {
        var obj=document.getElementsByName('login_protname_selectrule');
        var selectwhitelistid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectwhitelistid += obj[i].value;
            }
        }
        
        if(checknum != 1 )
        {
            alert("请勾选需要修改的白名单，不支持勾选多条规则！");
            return;
        }        
        
        ShowDiv('login_protName_protect_add','fade','whitelist_access_control');
        {% for whitelist in whitelists %}
            if ( '{{whitelist.whitelist}}' == selectwhitelistid )
            {
                document.getElementById('login_protName_whitelist').value='{{whitelist.whitelist}}';
                document.getElementById('login_protName_remark').value='{{whitelist.remark}}';
                document.getElementById('login_protName_id').value='{{whitelist.whitelist}}';
            }
        {% endfor %}            
    }
    
    <!--删除勾选Ip认证的白名单-->
    function delwhitelistip()
    {
        var obj=document.getElementsByName('login_protip_selectrule');
        var selectwhitelistid='';

        var selectedwhitelist= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectwhitelistid += obj[i].value + ';';
                {% for whitelist in whitelists %}
                    if(obj[i].value == '{{whitelist.whitelist}}')
                    {
                        if('[' != selectedwhitelist)
                        {
                            selectedwhitelist += ',';
                        }

                        var Type = 0;
                        if('COMPUTER_NAME' == '{{whitelist.authmethod}}')
                        {
                            Type = 1;
                        }

                        var singlewhitelist = '{"Id":"{0}","Type":{1}}'.format('{{whitelist.whitelist}}',Type);

                        selectedwhitelist += singlewhitelist;
                    }
                {% endfor %}
            }
        }
        selectedwhitelist += ']';

        if('' == selectwhitelistid)
        {
            alert('至少勾选一条IP记录!');
            return;
        }


        $.get("../delwhitelist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectwhitelistid':selectwhitelistid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除IP认证白名单成功');
                var msg='{"method":"LogoInProtect","param": {0},"type": "delete"}'.format(selectedwhitelist);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除IP认证白名单失败');
            }
        }
        )
    }
    
    <!--删除勾选计算机名认证的白名单-->
    function delwhitelistname()
    {
        var obj=document.getElementsByName('login_protname_selectrule');
        var selectwhitelistid='';

		var selectedwhitelist= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectwhitelistid += obj[i].value + ';';
				{% for whitelist in whitelists %}
                    if(obj[i].value == '{{whitelist.whitelist}}')
                    {
                        if('[' != selectedwhitelist)
                        {
                            selectedwhitelist += ',';
                        }

                        var Type = 0;
                        if('COMPUTER_NAME' == '{{whitelist.authmethod}}')
                        {
                            Type = 1;
                        }

                        var singlewhitelist = '{"Id":"{0}","Type":{1}}'.format('{{whitelist.whitelist}}',Type);

                        selectedwhitelist += singlewhitelist;
                    }
                {% endfor %}
            }
        }
		selectedwhitelist += ']';
		
		if('' == selectwhitelistid)
        {
            alert('至少勾选一条计算机名认证记录!');
            return;
        }

        $.get("../delwhitelist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectwhitelistid':selectwhitelistid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除计算机名认证的白名单成功');
				var msg='{"method":"LogoInProtect","param": {0},"type": "delete"}'.format(selectedwhitelist);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除计算机名认证的白名单失败');
            }
        }
        )
    }
	<!--清空超级黑名单详情页面的内容-->
    function clean_superblacklist_div()
    {
        $('#superblacklist_oneip').removeClass("on");
        $('#superblacklist_segmentip').removeClass("on");
        $(".tab_box_superblacklist > div").eq(0).show().siblings().hide();
        document.getElementById('super_blacklist_addr').value='';
        document.getElementById('super_blacklist_oneip_remark').value='';
		document.getElementById('super_blacklist_start_addr').value='';
		document.getElementById('super_blacklist_end_addr').value='';
		document.getElementById('super_blacklist_ips_remark').value='';
        document.getElementById('super_blacklist_id').value='';
    }

    <!--添加超级黑名单-->
    function AddSuperblacklist()
    {
        clean_superblacklist_div();
        $('#superblacklist_oneip').addClass("on");
    }


    <!-- 保存超级黑名单 -->
    function SaveSuperblacklist(iptype)
    {
        var addr = document.getElementById('super_blacklist_addr').value;
        var tmpnote = document.getElementById('super_blacklist_oneip_remark').value;
        var ipremark = document.getElementById('super_blacklist_oneip_remark').value.replace(/\n/g, '_@').replace(/\r/g, '_#');
		var startip = document.getElementById('super_blacklist_start_addr').value;
        var endip = document.getElementById('super_blacklist_end_addr').value;
        var tmpnotes = document.getElementById('super_blacklist_ips_remark').value;
        var ipsremark = document.getElementById('super_blacklist_ips_remark').value.replace(/\n/g, '_@').replace(/\r/g, '_#');
        var superlistid = document.getElementById('super_blacklist_id').value;

        var startiparray = [];
        var endiparray = [];
        var singleiparray = [];
        var oldIp = '';

        if('' != startip && '' != startip && endip && 'ipsegment' == iptype)
        {
            if(false == checkIPsegment(startip,endip))
            {
                alert("IP地址段格式错误");
                return;
            }

            startiparray.push(startip);
            endiparray.push(endip);
        }

        if('' != addr && 'singleip' == iptype)
        {
            singleiparray.push(addr);
        }

        {% for superlist in superlists %}
             if(superlistid == '{{superlist.id}}')
             {
                 {% if superlist.addr %}
                    oldIp = '{{superlist.addr}}';
                 {% else %}
                    oldIp = '{{superlist.startip}}' + '-' + '{{superlist.endip}}';
                 {% endif %}
             }

            {% if superlist.addr %}
                if(superlistid != '{{superlist.id}}')
                {
                    singleiparray.push('{{superlist.addr}}');
                }
            {% else %}
                if(superlistid != '{{superlist.id}}')
                {
                    startiparray.push('{{superlist.startip}}');
                    endiparray.push('{{superlist.endip}}');
                }
            {% endif %}
        {% endfor %}

        if(!checkIPsegmentDup(startiparray,endiparray)|| checkSingleIPDup(singleiparray)|| !checkIPsegmentHasIP(startiparray,endiparray,singleiparray))
        {
            alert("IP地址冲突");
            return;
        }

        var type= 'add';
        if('' != superlistid)
        {
            type = 'modify';
        }

        var signalIp='';
        var segmentIp='';
        var note = '';
        if('' != addr && 'singleip' == iptype)
        {
            signalIp = addr;
            note = tmpnote;
        }

        if('' != startip && '' != endip && 'ipsegment' == iptype)
        {
            segmentIp = startip + '-' + endip;
            note = tmpnotes;
        }

        $.get("../savesuperlist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','listtype':'SUPER_BLACKLIST','addr':addr,'ipremark':ipremark,'startip':startip,'endip':endip,'ipsremark':ipsremark,'superlistid':superlistid,'iptype':iptype}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存超级黑名单成功');
                var msg='{"method": "BlackList","param":[{"segmentIp":"{0}","signalIp":"{1}","Note":"{2}","oldIp":"{3}"}],"type":"{4}"}'.format(segmentIp,signalIp,note,oldIp,type);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存超级黑名单失败');
            }
        }
        )
    }
        
    <!-- 修改勾选的超级黑名单 -->
    function changesuperblacklist()
    {
        var obj=document.getElementsByName('super_blacklist_selectrule');
        var selectsuperlisttid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectsuperlisttid += obj[i].value;
            }
        }
        
        if(checknum != 1 )
        {
            alert("请勾选需要修改超级黑名单，不支持勾选多条规则！");
            return;
        }        

        clean_superblacklist_div();
        ShowDiv('super_blacklist_protect_add','fade','super_blacklist');
        {% for superlist in superlists %}
            if ( '{{superlist.id}}' == selectsuperlisttid )
            {
				var singleip = '{{superlist.addr}}';
				if('None' != singleip)
				{
                    $('#superblacklist_oneip').addClass("on");
                    $(".tab_box_superblacklist > div").eq(0).show().siblings().hide();
					document.getElementById('super_blacklist_addr').value = singleip;
                    var newremark = '{{superlist.ipremark}}';
                    newremark = newremark.replace(/_@/g, '\r\n');
					document.getElementById('super_blacklist_oneip_remark').value  = newremark;
				}
				else
				{
					$('#superblacklist_segmentip').addClass("on");
                    $(".tab_box_superblacklist > div").eq(1).show().siblings().hide();
					document.getElementById('super_blacklist_start_addr').value='{{superlist.startip}}';
					document.getElementById('super_blacklist_end_addr').value='{{superlist.endip}}';
                    var newremark = '{{superlist.ipsremark}}';
                    newremark = newremark.replace(/_@/g, '\r\n');
					document.getElementById('super_blacklist_ips_remark').value=newremark;
				}             			
                document.getElementById('super_blacklist_id').value='{{superlist.id}}';
            }
        {% endfor %}        
    }
    
    <!--删除勾选超级黑名单-->
    function delselectsuperlist()
    {
        var obj=document.getElementsByName('super_blacklist_selectrule');
        var selectsuperlisttid='';

        var selectedurl= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectsuperlisttid += obj[i].value + ';';
                {% for superlist in superlists %}
                    if(obj[i].value == {{superlist.id}})
                    {
                        if('[' != selectedurl)
                        {
                            selectedurl += ',';
                        }

                        var addr = '';
                        if('None' != '{{superlist.addr}}')
                        {
                            addr = '"{{superlist.addr}}"';
                        }
                        else if('None' != '{{superlist.startip}}')
                        {
                            addr = '"' + '{{superlist.startip}}' + '-' + '{{superlist.endip}}' + '"';
                        }

                        selectedurl += addr;
                    }
                {% endfor %}
            }
        }
        selectedurl += ']';
        
        if('' == selectsuperlisttid )
        {
            return;
        }

        $.get("../delsuperlist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectsuperlisttid':selectsuperlisttid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除超级黑名单成功');
                var msg='{"method": "BlackList","param": {0},"type": "del"}'.format(selectedurl);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除超级黑名单失败');
            }
        }
        )
    }
    
    
    <!-- 保存超级白名单 -->
    function SaveSuperwhitelist(iptype)
    {
        var addr = document.getElementById('super_whitelist_addr').value; 
		var tmpnote = document.getElementById('super_whitelist_oneip_remark').value;
        var ipremark = document.getElementById('super_whitelist_oneip_remark').value.replace(/\n/g, '_@').replace(/\r/g, '_#');
        var startip = document.getElementById('super_whitelist_start_addr').value;
        var endip = document.getElementById('super_whitelist_end_addr').value;
		var tmpnotes = document.getElementById('super_whitelist_ips_remark').value;
        var ipsremark = document.getElementById('super_whitelist_ips_remark').value.replace(/\n/g, '_@').replace(/\r/g, '_#');
		var superlistid = document.getElementById('super_whitelist_id').value;

		var startiparray = [];
        var endiparray = [];
        var singleiparray = [];
        var oldIp = '';

        if('' != startip && '' != startip && endip && 'ipsegment' == iptype)
        {
            if(false == checkIPsegment(startip,endip))
            {
                alert("IP地址段格式错误");
                return;
            }

            startiparray.push(startip);
            endiparray.push(endip);
        }

        if('' != addr && 'singleip' == iptype)
        {
            singleiparray.push(addr);
        }

        {% for superlist in superlists %}
            if(superlistid == '{{superlist.id}}')
             {
                 {% if superlist.addr %}
                    oldIp = '{{superlist.addr}}';
                 {% else %}
                    oldIp = '{{superlist.startip}}' + '-' + '{{superlist.endip}}';
                 {% endif %}
             }

            {% if superlist.addr %}
                if(superlistid != '{{superlist.id}}')
                {
                    singleiparray.push('{{superlist.addr}}');
                }
            {% else %}
                if(superlistid != '{{superlist.id}}')
                {
                    startiparray.push('{{superlist.startip}}');
                    endiparray.push('{{superlist.endip}}');
                }
            {% endif %}
        {% endfor %}

        if(!checkIPsegmentDup(startiparray,endiparray)|| checkSingleIPDup(singleiparray) || !checkIPsegmentHasIP(startiparray,endiparray,singleiparray))
        {
            alert("IP地址冲突");
            return;
        }
		

        var type= 'add';
        if('' != superlistid)
        {
            type = 'modify';
        }

        var signalIp='';
        var segmentIp='';
        var note = '';
        if('' != addr && 'singleip' == iptype)
        {
            signalIp = addr;
            note = tmpnote;
        }

        if('' != startip && '' != endip && 'ipsegment' == iptype)
        {
            segmentIp = startip + '-' + endip;
            note = tmpnotes;
        }

        $.get("../savesuperlist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','listtype':'SUPER_WHITELIST','addr':addr,'ipremark':ipremark,'startip':startip,'endip':endip,'ipsremark':ipsremark,'superlistid':superlistid,'iptype':iptype}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存超级白名单成功');
                var msg='{"method": "WhiteList","param":[{"segmentIp":"{0}","signalIp":"{1}","Note": "{2}","oldIp":"{3}"}],"type":"{4}"}'.format(segmentIp,signalIp,note,oldIp,type);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存超级白名单失败');
            }
        }
        )
    }

    <!--清空超级白名单详情页面的内容-->
    function clean_superwhitelist_div()
    {
		$('#superwhitelist_oneip').removeClass("on");
        $('#superwhitelist_segmentip').removeClass("on");
        $(".tab_box_superwhiteist > div").eq(0).show().siblings().hide();
        document.getElementById('super_whitelist_addr').value='';
        document.getElementById('super_whitelist_oneip_remark').value='';
        document.getElementById('super_whitelist_id').value='';
        document.getElementById('super_whitelist_start_addr').value='';
        document.getElementById('super_whitelist_end_addr').value='';
        document.getElementById('super_whitelist_ips_remark').value='';
    }
	
	<!--添加超级白名单-->
    function AddSuperwhitelist()
    {
        clean_superwhitelist_div();
        $('#superwhitelist_oneip').addClass("on");
    }


    <!-- 修改勾选的超级白名单 -->
    function changesuperlist()
    {
        var obj=document.getElementsByName('super_whitelist_selectrule');
        var selectsuperlisttid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectsuperlisttid += obj[i].value;
            }
        }
        
        if(checknum != 1 )
        {
            alert("请勾选需要修改的超级白名单，不支持勾选多条规则！");
            return;
        }        
        
		clean_superwhitelist_div();
        ShowDiv('super_whitelist_protect_add','fade','super_whitelist');
        {% for superlist in superlists %}
            if ( '{{superlist.id}}' == selectsuperlisttid )
            {                    
				var singleip = '{{superlist.addr}}';
				if('None' != singleip)
				{
                    $('#superwhitelist_oneip').addClass("on");
                    $(".tab_box_superwhiteist > div").eq(0).show().siblings().hide();
					document.getElementById('super_whitelist_addr').value = singleip;
					var newremark = '{{superlist.ipremark}}';
                    newremark = newremark.replace(/_@/g, '\r\n');
					document.getElementById('super_whitelist_oneip_remark').value=newremark;
				}
				else
				{
					$('#superwhitelist_segmentip').addClass("on");
                    $(".tab_box_superwhiteist > div").eq(1).show().siblings().hide();
					document.getElementById('super_whitelist_start_addr').value='{{superlist.startip}}';
					document.getElementById('super_whitelist_end_addr').value='{{superlist.endip}}';
					var newremark = '{{superlist.ipsremark}}';
                    newremark = newremark.replace(/_@/g, '\r\n');
					document.getElementById('super_whitelist_ips_remark').value=newremark;
				}				
                document.getElementById('super_whitelist_id').value='{{superlist.id}}';
                
            }
        {% endfor %}        
    }
    
    <!--删除勾选超级白名单-->
    function delselectsuperwhitelist()
    {
        var obj=document.getElementsByName('super_whitelist_selectrule');
        var selectsuperlisttid='';

		var selectedurl= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectsuperlisttid += obj[i].value + ';';
				{% for superlist in superlists %}
                    if(obj[i].value == {{superlist.id}})
                    {
                        if('[' != selectedurl)
                        {
                            selectedurl += ',';
                        }

                        var addr = '';
                        if('None' != '{{superlist.addr}}')
                        {
                            addr = '"{{superlist.addr}}"';
                        }
                        else if('None' != '{{superlist.startip}}')
                        {
                            addr = '"' + '{{superlist.startip}}' + '-' + '{{superlist.endip}}' + '"';
                        }

                        selectedurl += addr;
                    }
                {% endfor %}
            }
        }
        selectedurl += ']';
		
        if('' == selectsuperlisttid )
        {
            return;
        }

        $.get("../delsuperlist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectsuperlisttid':selectsuperlisttid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除超级白名单成功');
				var msg='{"method": "WhiteList","param": {0},"type": "del"}'.format(selectedurl);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除超级白名单失败');
            }
        }
        )
    }

    <!--对ip地址段进行判断-->
    function checkIPsegment(startip,endip)
    {
        if('' == startip || '' ==endip)
        {
            return false;
        }

        var startarray = startip.split(".");
        var endarray = endip.split(".");
        if(startarray[0] != endarray[0] || startarray[1] != endarray[1])
        {
            return false;
        }

        for(var i=2;i<4;i++)
        {
            var startnum = parseInt(startarray[i]);
            var endnum = parseInt(endarray[i]);

            if(startnum > endnum)
            {
                return false;
            }
        }
        return true;
    }

    <!--检查、判断singleIP是否重复-->
    function checkSingleIPDup(singleiparray)
    {
        var sortports = singleiparray.sort();

        for(var i = 0; i < sortports.length - 1; i++)
        {
           if (sortports[i] == sortports[i+1])
            {
               return true;
            }
        }
        return false;
    }

    <!--IP地址转数字-->
    function ipToNumber(ip)
    {
        var num = 0;
        if(ip == "") {
            return num;
        }
        var aNum = ip.split(".");
        if(aNum.length != 4) {
            return num;
        }
        num += parseInt(aNum[0]) << 24;
        num += parseInt(aNum[1]) << 16;
        num += parseInt(aNum[2]) << 8;
        num += parseInt(aNum[3]) << 0;
        num = num >>> 0;//这个很关键，不然可能会出现负数的情况
        return num;
    }

    <!--数字转IP地址-->
    function numberToIp(number)
    {
        var ip = "";
        if(number <= 0) {
            return ip;
        }
        var ip3 = (number << 0 ) >>> 24;
        var ip2 = (number << 8 ) >>> 24;
        var ip1 = (number << 16) >>> 24;
        var ip0 = (number << 24) >>> 24

        ip += ip3 + "." + ip2 + "." + ip1 + "." + ip0;

        return ip;
    }

    <!--判断两端整数段是否由交集-->
    function checkhasDup(startnuma,endnuma,startnumb,endnumb)
    {
        if(startnumb>endnuma && endnumb>startnuma || startnumb< endnuma && endnumb<startnuma)
        {

            console.log('没有交集'+ numberToIp(startnuma)+'-'+numberToIp(endnuma) + ';' + numberToIp(startnumb)+'-'+numberToIp(endnumb));
            return true;
        }
        console.log('包含交集'+ numberToIp(startnuma)+'-'+numberToIp(endnuma) + ';' + numberToIp(startnumb)+'-'+numberToIp(endnumb));
        return false;
    }

    <!--判断IP地址段是否重复、交叉-->
    function checkIPsegmentDup(startiparray,endarray)
    {
        var startnumarray = [];
        var endnumarray = [];
        for(var j=0;j<startiparray.length;j++)
        {
            var startnum = ipToNumber(startiparray[j]);
            var endnum = ipToNumber(endarray[j]);

            startnumarray.push(startnum);
            endnumarray.push(endnum);
        }

        for(var i=0;i<startnumarray.length;i++)
        {
            for(var j=0;j<startnumarray.length-1;j++)
            {
                if(!checkhasDup(startnumarray[j],endnumarray[j],startnumarray[j+1],endnumarray[j+1]))
                {
                    return false;
                }
            }
        }
        return true;
    }
    
	
	function checkIPsegmentHasIP(startiparray,endarray,singleiparray)
	{
		var startnumarray = [];
        var endnumarray = [];
        for(var j=0;j<startiparray.length;j++)
        {
            var startnum = ipToNumber(startiparray[j]);
            var endnum = ipToNumber(endarray[j]);

            startnumarray.push(startnum);
            endnumarray.push(endnum);
        }
		
		for(var i=0;i<singleiparray.length;i++)
		{
            if('' == checkisIp(singleiparray[i]))
            {
                continue;
            }

			var singleIPnum = ipToNumber(singleiparray[i]);
			for(var j=0;j<startnumarray.length;j++)
			{
				if(singleIPnum>=startnumarray[j] && singleIPnum<=endnumarray[j])
				{
					return false;
				}
			}
		}
		return true;
	}
	
    <!-- 保存修改用户的端口安全策略 -->
    function saveposrtsecurity()
    {
        var port = document.getElementById('port_security_port').value; 
        var portid = document.getElementById('port_security_port_id').value;
        var protocol = document.getElementById('port_security_port_protocol').value;
        
        <!-- 获取协议 -->
        var myselect=document.getElementById('port_security_seclet');
        var protocoltype = myselect.value;
        var index = myselect.selectedIndex;

        if('' == port)
        {
            alert("端口不合法");
            return;
        }

        if(index<4 && index>1 )
        {
            if(0 != port)
            {
                alert("ICMP或IGMP协议类型的端口设置只能为0");
                return;
            }
        }

        if(0 == port)
        {
            if(index<2 || index>3 )
            {
                alert("端口0只能用于ICMP或IGMP协议类型");
                return;
            }
        }
        
        <!-- 获取规则 -->
        var ruleselect=document.getElementById('port_security_rule_seclet');
        var ruletype = false;
        if('port_security_acceptall' == ruleselect.value)
        {
            ruletype = true;
        }
        var ruleindex = ruleselect.selectedIndex;

        <!--地址段-->
        var ipsegment = '';
        var segmentIp = '['
        var obj=document.getElementsByName("startip");
        var endipobj=document.getElementsByName("endip");
		var startiparray = [];
        var endiparray = [];
        for(var i=0; i<obj.length; i++)
        {
            if('' == obj[i].value && '' == endipobj[i].value )
            {
                continue;
            }

            if('' == obj[i].value ||'' == endipobj[i].value )
            {
                alert("IP地址段不匹配");
                return;
            }

			startiparray.push(obj[i].value);
			endiparray.push(endipobj[i].value);
            if(false == checkIPsegment(obj[i].value,endipobj[i].value))
            {
                alert("IP地址段格式错误");
                return;
            }

            ipsegment += obj[i].value + ':' + endipobj[i].value + ';';
            if('[' != segmentIp)
            {
                segmentIp += ',';
            }
            segmentIp += '"' + obj[i].value + '-' + endipobj[i].value + '"';
        }
        segmentIp += ']';

        if(!checkIPsegmentDup(startiparray,endiparray))
        {
            alert("IP地址段存在交集");
            return;
        }

        <!-- 单独IP -->
        var singleip = document.getElementById('singleip').value;
        var singleiparray = singleip.split(';');

        if('' != singleip && false == checkIPsegmentHasIP(startiparray,endiparray,singleiparray))
        {
            alert("请输入正确的IP地址");
            return;
        }

        var type = '';
        if(''!=portid)
        {
            type = 'modify';
        }
        else
        {
            type = 'add';
        }

        $.get("../addportsecurity",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','port':port,'portid':portid,'protocoltype':index,'ruletype':ruleindex,'singleip':singleip,'ipsegment':ipsegment}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存端口成功');
                var msg = '{"method":"PortPolicy","param":[{"PortNum":"{PortNum}","Protocol":"{Protocol}","oldProtocol":"{protocol}","Strategies":{Strategies},"segmentIp":{segmentIp},"signalIp":"{signalIp}"}],"type":"{type}"}'.format({PortNum:port,Protocol:protocoltype,protocol:protocol,Strategies:ruletype,segmentIp:segmentIp,signalIp:singleip,type:type});
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存端口失败');
            }
        }
        )        
        
    }

    <!--清空修改端口策略div-->
    function clean_port_add_div()
    {
        document.getElementById('port_security_port').value='';
        document.getElementById('port_security_port_id').value='';
        document.getElementById('port_security_port_protocol').value='';
        document.getElementById("port_security_seclet").selectedIndex = 0;
        document.getElementById("port_security_rule_seclet").selectedIndex = 0;
        $("#tbipsegment").html("");
        document.getElementById('singleip').value='';
        document.getElementById('port_security_port').removeAttribute("disabled");
    }

    <!-- 修改勾选的端口安全策略 -->
    function changeportsecurity()
    {
        var obj=document.getElementsByName('port_security_selectrule');
        var selectportsecurityid = '';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectportsecurityid += obj[i].value;
            }
        }
        
        if(checknum != 1 )
        {
            alert("请勾选需要修改的端口安全策略，不支持勾选多条规则！");
            return;
        }

        clean_port_add_div();
        document.getElementById('port_security_titleid').innerHTML='修改端口安全策略';
        $('#port_security_port').attr('disabled','disabled');

        ShowDiv('port_security_protect_add','fade','port_security');
        {% for port in ports %}
            if ( '{{port.id}}' == selectportsecurityid )
            {                    
                document.getElementById('port_security_port').value='{{port.port}}';
                document.getElementById('port_security_port_id').value='{{port.id}}';
                document.getElementById('port_security_port_protocol').value='{{port.protocol}}';

                
                <!--端口协议类型-->
                if( '{{port.protocol}}' == 'TCP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 0;
                }
                else if ( '{{port.protocol}}' == 'UDP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 1;
                }
                else if ( '{{port.protocol}}' == 'ICMP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 2;
                }
                else if ( '{{port.protocol}}' == 'IGMP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 3;
                }
                else if ( '{{port.protocol}}' == 'IP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 4;
                }
                else if ( '{{port.protocol}}' == 'RDP' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 5;
                }
                else if ( '{{port.protocol}}' == 'ALL' )
                {
                    document.getElementById("port_security_seclet").selectedIndex = 6;
                }
                
                <!--端口规则类型-->
                if( '{{port.rule}}' == '所有IP一律拒绝' )
                {
                    document.getElementById("port_security_rule_seclet").selectedIndex = 0;
                }
                else if ( '{{port.rule}}' == '所有IP一律运行' )
                {
                    document.getElementById("port_security_rule_seclet").selectedIndex = 1;
                }

                <!--IP地址段-->
                var isNull = true;

                {% for portsegment in portsegments %}
                    {% if portsegment.port = port.port %}
                        {% if portsegment.protocol = port.protocol %}
                            addipsegment('{{portsegment.startip}}','{{portsegment.endip}}');
                            isNull = false;
                        {% endif %}
                    {% endif %}
                {% endfor %}

                if(isNull)
                {
                    addipsegment();
                }

                document.getElementById('singleip').value='{{port.exception}}';
            }
        {% endfor %}        
    }
    
    <!--删除勾选的端口安全策略-->
    function delselectport()
    {
        var obj=document.getElementsByName('port_security_selectrule');
        var selectportid = '';

        var selectedport= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectportid += obj[i].value + ';';

                {% for port in ports %}
                    if(obj[i].value == {{port.id}})
                    {
                        if('[' != selectedport)
                        {
                            selectedport += ',';
                        }
                        var portinfo = '{"PortNum":"{{port.port}}","Protocol":"{{port.protocol}}"}'
                        selectedport += portinfo;
                    }
                {% endfor %}
            }
        }
        selectedport += ']';

        if('' == selectportid)
        {
            alert("请至少勾选一条端口策略");
            return;
        }

        $.get("../delport",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectportid':selectportid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除端口安全策略成功');
                var msg='{"method":"PortPolicy","param":{0},"type": "del"}'.format(selectedport);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除端口安全策略失败');
            }
        }
        )
    }
    
    <!-- 保存添加的自定义网关IP和MAC绑定对 -->
    function SaveCustomizeGateway()
    {
        var ip = document.getElementById('localip').value;
        var mac = document.getElementById('localmac').value;
        var gatewayip = document.getElementById('gatewayip').value;
		var gatewaymac = document.getElementById('gatewaymac').value;

        var msg='{"method":"IpNetinfo","param": {"LocalIp":"{0}","LocalMac":"{1}","GatewayIp":"{2}","GatewayMac":"{3}"},"type": "modify"}'.format(ip,mac,gatewayip,gatewaymac);
        EncryptMsg(msg);
    }

    <!-- 修改勾选的自定义网关IP和MAC绑定对 -->
    function changecustomizegateway()
    {
        var obj=document.getElementsByName('customize_gateway_selectrule');
        var selectgatewayid='';
        var checknum= 0;

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                checknum++;
                selectgatewayid += obj[i].value;
            }
        }

        if(checknum != 1 )
        {
            alert("请勾选需要修改自定义网关IP和MAC对，不支持勾选多条规则！");
            return;
        }

        ShowDiv('ARPfirwall_customize_gateway_protect_add','fade','customize_gateway');
        {% for gateway in gateways %}
            if ( '{{gateway.id}}' == selectgatewayid )
            {
                document.getElementById('customize_gateway_addr').value='{{gateway.IP}}';
                document.getElementById('customize_gateway_remark').value='{{gateway.MAC}}';
                document.getElementById('customize_gateway_id').value='{{gateway.id}}';
            }
        {% endfor %}
    }

    <!--删除勾选自定义网关IP和MAC绑定对-->
    function delselectcustomizegateway()
    {
        var obj=document.getElementsByName('customize_gateway_selectrule');
        var selectgatewayid='';

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectgatewayid += obj[i].value + ';';
            }
        }

        if('' == selectgatewayid )
        {
            return;
        }

        $.get("../delcustomgateway",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectgatewayid':selectgatewayid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除网关IP和MAC对成功');
            }
            else
            {
                alert('删除网关IP和MAC对失败');
            }
        }
        )
    }

    <!--URL白名单-->
    function AddUrlWhiteList()
    {
        document.getElementById('URLwhitelist_protect_add').style.display='table-row';
    }

    function CancelAddurlWhiteList()
    {
        document.getElementById('URLwhitelist_protect_add').style.display='none';
    }

    function isURL(str_url)
    {
        var lowerUrl = str_url.toLowerCase();
        if(0 == lowerUrl.indexOf("http://") || 0== lowerUrl.indexOf("https://"))
        {
            return true;
        }
        return false;

        <!--var Expression=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;-->
        <!--var objExp=new RegExp(Expression);-->

        <!--if(objExp.test(str_url)==true){-->
            <!--return true;-->
        <!--}else{-->
            <!--return false;-->
        <!--}-->
    }


    <!--保存URL白名单-->
    function saveurlwhitelist()
    {
        var url = document.getElementById('URLwhitelist_url').value;
        var remark = '';

        if('' == url)
        {
            alert("Url不能为空");
            return;
        }

        if(!isURL(url))
        {
            alert("Url格式错误");
            return;
        }

        {% for urlwhitelist in urlwhitelists %}
            var srcstr = '{{urlwhitelist.url}}';
            if(srcstr.toLowerCase() == url.toLowerCase())
            {
                alert("Url重复");
                return;
            }

        {% endfor %}

        $.get("../saveurlwhitelist",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','url':url,'remark':remark,'urlwhitelisrtid':''}, function(ret)
        {
            if(ret == 'success')
            {
                alert('保存URL白名单成功');
                var msg='{"method":"wcUrlPath","param": ["{0}"],"type": "add"}'.format(url);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('保存URL白名单失败');
            }
        }
        )
    }

    function delselecturlwhitelist()
    {
        var obj=document.getElementsByName('URLwhitelist_selectrule');
        var selecturlwhitelistid='';

        var selectedurl= '[';
        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selecturlwhitelistid += obj[i].value + ';';

                {% for url in urlwhitelists %}
                    if(obj[i].value == {{url.id}})
                    {
                        if('[' != selectedurl)
                        {
                            selectedurl += ',';
                        }
                        selectedurl += '"{{url.url}}"';
                    }
                {% endfor %}
            }
        }
        selectedurl += ']'

        if('' == selecturlwhitelistid )
        {
            return;
        }

        $.get("../delurlwhitelistid",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selecturlwhitelistid':selecturlwhitelistid},function(ret)
        {
            if(ret == 'success')
            {
                alert('删除URL白名单成功');
                var msg='{"method":"wcUrlPath","param":{0},"type": "del"}'.format(selectedurl);
                EncryptMsg(msg,true);
            }
            else
            {
                alert('删除URL白名单失败');
            }
        }
        )
    }
    
    $(document).ready(function()
    {
        <!-- 点击切换div -->
        $(function()
        {
             $(".tab_menu ul li").click(function()
             {
                <!-- 切换选中的按钮高亮状态 -->
                $(this).addClass("on").siblings().removeClass("on"); 
                <!-- 获取被按下按钮的索引值，需要注意index是从0开始的 -->
                var index=$(this).index(); 
                var liid = $(this).attr('id'); 
                
                <!-- 在按钮选中时在下面显示相应的内容，同时隐藏不需要的框架内容 -->
                highsetindex = index;
                if(liid.indexOf("file_prot")>-1)
                {
                    $("#file_prot_div > div").eq(index).show().siblings().hide(); 
                }
                else if(liid.indexOf("registry_prot")>-1)
                {
                    $("#registry_prot_div > div").eq(index).show().siblings().hide(); 
                }
                else if(liid.indexOf("login_prot")>-1)
                {
                    $("#login_prot_div > div ").eq(index).show().siblings().hide(); 
                }
                else if(liid.indexOf("superwhitelist")>-1)
                {
                    $("#superwhitelist_div > div ").eq(index).show().siblings().hide();
                }
				else if(liid.indexOf("superblacklist")>-1)
                {
                    $("#superblacklist_div > div ").eq(index).show().siblings().hide();
                } 
				else if(liid.indexOf("interceptIP")>-1)
                {
                    $("#interceptIP_div > div ").eq(index).show().siblings().hide();
                }

             });
        });

        <!-- 全选取消全选 -->
        $("#controlAll").click(function()
        {
            var checklist = document.getElementsByName ("file_prot_selectrule");
            if(document.getElementById("controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#registry_prot_controlAll").click(function()
        {
            var checklist = document.getElementsByName ("registry_prot_selectrule");
            if(document.getElementById("registry_prot_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#process_behavior_controlAll").click(function()
        {
            var checklist = document.getElementsByName("process_behavior_selectrule");
            if(document.getElementById("process_behavior_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#login_protIP_controlAll").click(function()
        {
            var checklist = document.getElementsByName("login_protip_selectrule");
            if(document.getElementById("login_protIP_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#login_protName_controlAll").click(function()
        {
            var checklist = document.getElementsByName("login_protname_selectrule");
            if(document.getElementById("login_protName_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#super_blacklist_controlAll").click(function()
        {
            var checklist = document.getElementsByName("super_blacklist_selectrule");
            if(document.getElementById("super_blacklist_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#super_whitelist_controlAll").click(function()
        {
            var checklist = document.getElementsByName("super_whitelist_selectrule");
            if(document.getElementById("super_whitelist_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#port_security_controlAll").click(function()
        {
            var checklist = document.getElementsByName("port_security_selectrule");
            if(document.getElementById("port_security_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#customize_gateway_controlAll").click(function()
        {
            var checklist = document.getElementsByName("customize_gateway_selectrule");
            if(document.getElementById("customize_gateway_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#URLwhitelist_controlAll").click(function()
        {
            var checklist = document.getElementsByName("URLwhitelist_selectrule");
            if(document.getElementById("URLwhitelist_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#blocked_IP_controlAll").click(function()
        {
            var checklist = document.getElementsByName("selectblockip");
            if(document.getElementById("blocked_IP_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });

        <!-- 全选取消全选 -->
        $("#allowed_IP_controlAll").click(function()
        {
            var checklist = document.getElementsByName("selectallowip");
            if(document.getElementById("allowed_IP_controlAll").checked)
            {
               for(var i=0;i<checklist.length;i++)
               {
                  checklist[i].checked = 1;
               }
             }else{
              for(var j=0;j<checklist.length;j++)
              {
                 checklist[j].checked = 0;
              }
             }
        });
    });

    <!-- 全选取消全选 -->
    function preocess_behavior_chooseallornot(opt)
    {
        var checklist = document.getElementsByName("process_behavior_trail");
        if(opt=='open')
        {
           for(var i=0;i<checklist.length;i++)
           {
              checklist[i].checked = 1;
           }
         }else{
          for(var j=0;j<checklist.length;j++)
          {
             checklist[j].checked = 0;
          }
         }
    }

    $(document).ready(function()
    {
        $("#account_prot").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'account_prot'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("account_prot").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"ACCOUNT": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });


        $("#file_prot").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'file_prot'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("file_prot").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"FILE": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#registry_prot").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'registry_prot'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("registry_prot").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"REGISTER": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#outside_control").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'outside_control'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("outside_control").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"DEVICE": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#process_behavior").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'process_behavior'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("process_behavior").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"PROCESS": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        <!-- $("#app_control").click(function() -->
        <!-- { -->
            <!-- $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'app_control'}, function(ret) -->
            <!-- { -->
                <!-- loadret(ret); -->
                <!-- var divclass = document.getElementById("app_control").className; -->
                <!-- var rulestatus = false; -->
                <!-- if('icon_open_a' == divclass) -->
                <!-- { -->
                    <!-- rulestatus = true; -->
                <!-- } -->
                <!-- var msg = '{"method": "sysfirewallmaincfig", "param": {"ACCOUNT": {0}} }'.format(rulestatus); -->
                <!-- EncryptMsg(msg); -->
            <!-- }) -->
        <!-- }); -->

        $("#remote_login_remind").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'remote_login_remind'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("remote_login_remind").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"REMOTE": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#whitelist_access_control").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'whitelist_access_control'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("whitelist_access_control").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "sysfirewallmaincfig", "param": {"WHITE": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#nochangadmin_pass").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'nochangadmin_pass'}, function(ret)
            {
                loadret(ret);

                var divclass = document.getElementById("nochangadmin_pass").className;
                var status = false;
                if('icon_open_a' == divclass)
                {
                    status = true;
                }
                var msg = '{"method":"accountProtect","param":[{"name":"superManger","status":{0},"type":1}],"type":"modifyStatus"}'.format(status);
                EncryptMsg(msg);
            })
        });

        $("#usergroup_prot").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'usergroup_prot'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("usergroup_prot").className;
                var status = false;
                if('icon_open_a' == divclass)
                {
                    status = true;
                }
                var msg = '{"method":"accountProtect","param":[{"name":"userGroup","status":{0},"type":1}],"type":"modifyStatus"}'.format(status);
                EncryptMsg(msg);
            })
        });

        $("#ARPfirwall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'ARPfirwall'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("ARPfirwall").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"ARPFireWall": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });


        $("#DDosfirwall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'DDosfirwall'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("DDosfirwall").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"DDosFireWall": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#Web_firwall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'Web_firwall'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("Web_firwall").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"WebFireWall": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#FTP_avoidviolence").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'FTP_avoidviolence'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("FTP_avoidviolence").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"FTPProtect": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#ReDesktop_avoidviolence").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'ReDesktop_avoidviolence'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("ReDesktop_avoidviolence").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"RemoteProtect": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#MySQL_avoidviolence").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'MySQL_avoidviolence'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("MySQL_avoidviolence").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"MySQLProtect": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#MSSQL_avoidviolence").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'MSSQL_avoidviolence'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("MSSQL_avoidviolence").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"MSSQLProtect": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#port_security").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'port_security'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("port_security").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"PortPolicy": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#forbid_ping").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'forbid_ping'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("forbid_ping").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"ForbidPing": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#super_blacklist").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'super_blacklist'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("super_blacklist").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"BlakcList": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        $("#super_whitelist").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'super_whitelist'}, function(ret)
            {
                loadret(ret);
                var divclass = document.getElementById("super_whitelist").className;
                var rulestatus = false;
                if('icon_open_a' == divclass)
                {
                    rulestatus = true;
                }
                var msg = '{"method": "netfirewallmaincfig", "param": {"WhiteList": {0}} }'.format(rulestatus);
                EncryptMsg(msg);
            })
        });

        <!--文件保护系统规则，单个开关点击开启关闭-->
        {% for sysrule in file_prot_sysrules %}
            $("#sysruleid_{{sysrule.id}}").click(function()
            {
                var rulename = '{{sysrule.rulename}}';
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'file_prot','obj':rulename}, function(ret)
                {
                    loadret(ret);
                    var divclass = document.getElementById("sysruleid_{{sysrule.id}}").className;
                    var rulestatus = false;
                    if('icon_open_a' == divclass)
                    {
                        rulestatus = true;
                    }


                    var msg = '{"method":"fileProtect","param":[{"ruleName":"[系统]{{sysrule.rulename}}","status":{0}}],"type":"modifyStatus"}'.format(rulestatus);

                    EncryptMsg(msg);
                })
            });
        {% endfor %}

        <!--文件保护自定义规则，单个开关点击开启关闭-->
        {% for userrule in file_prot_userrules %}
            $("#userruleid_{{userrule.id}}").click(function()
            {
                var rulename = '{{userrule.rulename}}';
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'file_prot','obj':rulename}, function(ret)
                {
                    loadret(ret);
                    var divclass = document.getElementById("userruleid_{{userrule.id}}").className;
                    var rulestatus = false;
                    if('icon_open_a' == divclass)
                    {
                        rulestatus = true;
                    }

                    var msg = '{"method":"fileProtect","param":[{"ruleName":"{{userrule.rulename}}","status":{0}}],"type":"modifyStatus"}'.format(rulestatus);
                    EncryptMsg(msg);
                })
            });
        {% endfor %}
        <!--文件保护系统预设规则一键开启或者关闭-->
        $("#file_prot_openallsys").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'file_prot_sysopenall'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for userrule in file_prot_sysrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }


                    ruletmp = '{"ruleName":"[系统]{0}","status":true}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method":"fileProtect","param":{0},"type":"modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        $("#file_prot_closeallsys").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'file_prot_syscloseall'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for userrule in file_prot_sysrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }

                    ruletmp = '{"ruleName":"[系统]{0}","status":false}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method": "fileProtect","param": {0},"type": "modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        <!--用户自定义规则一键开启或者关闭-->
        $("#file_prot_openall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'file_prot_openall'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for userrule in file_prot_userrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }
                    ruletmp = '{"ruleName":"{0}","status":true}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method": "fileProtect","param": {0},"type": "modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        $("#file_prot_closeall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'file_prot_closeall'}, function(ret)
            {
                loadret(ret);
                var selectedrule= '[';
                {% for userrule in file_prot_userrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }
                    ruletmp = '{"ruleName":"{0}","status":false}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method": "fileProtect","param": {0},"type": "modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        <!--注册表保护系统规则，单个开关点击开启关闭-->
        {% for sysrule in registry_prot_sysrules %}
            $("#sysruleid_{{sysrule.id}}").click(function()
            {
                var rulename = '{{sysrule.rulename}}';
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'registry_prot','obj':rulename}, function(ret)
                {
                    loadret(ret);
                    var divclass = document.getElementById("sysruleid_{{sysrule.id}}").className;
                    var rulestatus = false;
                    if('icon_open_a' == divclass)
                    {
                        rulestatus = true;
                    }

                    var msg = '{"method":"registerProtect","param":[{"ruleName":"{{sysrule.rulename}}","status":{0}}],"type":"modifyStatus"}'.format(rulestatus);

                    EncryptMsg(msg);
                })
            });
        {% endfor %}

        <!--注册表保护系统预设规则一键开启或者关闭-->
        $("#registry_prot_openallsys").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'registry_prot_openallsys'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for sysrule in registry_prot_sysrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }

                    if('禁止添加或修改自动运行程序1x86' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序1(x86)","status":true}';
                    }
                    else if('禁止添加或修改自动运行程序2x86' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序2(x86)","status":true}';
                    }
                    else if('禁止添加或修改自动运行程序1x64' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序1(x64)","status":true}';
                    }
                    else if('禁止添加或修改自动运行程序2x64' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序2(x64)","status":true}';
                    }
                    else
                    {
                        ruletmp = '{"ruleName":"{0}","status":true}'.format('{{sysrule.rulename}}');
                    }

                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method":"registerProtect","param":{0},"type":"modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        $("#registry_prot_closeallsys").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'registry_prot_closeallsys'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for sysrule in registry_prot_sysrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }

                    if('禁止添加或修改自动运行程序1x86' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序1(x86)","status":false}';
                    }
                    else if('禁止添加或修改自动运行程序2x86' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序2(x86)","status":false}';
                    }
                    else if('禁止添加或修改自动运行程序1x64' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序1(x64)","status":false}';
                    }
                    else if('禁止添加或修改自动运行程序2x64' == '{{sysrule.rulename}}' )
                    {
                        ruletmp = '{"ruleName":"禁止添加或修改自动运行程序2(x64)","status":false}';
                    }
                    else
                    {
                        ruletmp = '{"ruleName":"{0}","status":false}'.format('{{sysrule.rulename}}');
                    }

                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method":"registerProtect","param":{0},"type":"modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        <!--注册表保护自定义规则，单个开关点击开启关闭-->
        {% for userrule in registry_prot_userrules %}
            $("#userruleid_{{userrule.id}}").click(function()
            {
                var rulename = '{{userrule.rulename}}';
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'registry_prot','obj':rulename}, function(ret)
                {
                    loadret(ret);

                    var divclass = document.getElementById("userruleid_{{userrule.id}}").className;
                    var rulestatus = false;
                    if('icon_open_a' == divclass)
                    {
                        rulestatus = true;
                    }
                    var msg = '{"method":"registerProtect","param":[{"ruleName":"{{userrule.rulename}}","status":{0}}],"type":"modifyStatus"}'.format(rulestatus);
                    EncryptMsg(msg);
                })
            });
        {% endfor %}

        <!--注册表保护用户自定义规则一键开启或者关闭-->
        $("#registry_prot_openall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'registry_prot_openall'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for userrule in registry_prot_userrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }
                    ruletmp = '{"ruleName":"{0}","status":true}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method": "registerProtect","param": {0},"type": "modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        $("#registry_prot_closeall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'registry_prot_closeall'}, function(ret)
            {
                loadret(ret);

                var selectedrule= '[';
                {% for userrule in registry_prot_userrules %}

                    if('[' != selectedrule)
                    {
                        selectedrule += ',';
                    }
                    ruletmp = '{"ruleName":"{0}","status":false}'.format('{{userrule.rulename}}');
                    selectedrule += ruletmp;
                {% endfor %}
                selectedrule += ']';

                var msg='{"method": "registerProtect","param": {0},"type": "modifyStatus"}'.format(selectedrule);
                EncryptMsg(msg);
            })
        });

        {% for usergroup in usergroups %}
            $("#accountprot_{{usergroup.id}}").click(function()
            {
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'account_prot','obj':'{{usergroup.usergroup}}'}, function(ret)
                {
                    loadret(ret);

                    var divclass = document.getElementById("accountprot_{{usergroup.id}}").className;
                    var status = false;
                    if('icon_open_a' == divclass)
                    {
                        status = true;
                    }
                    var msg = '{"method":"accountProtect","param":[{"des":"","name":"{{usergroup.usergroup}}","status":{0},"type":0}],"type":"modifyStatus"}'.format(status);
                    EncryptMsg(msg);
                })
            });
        {% endfor %}

        <!--账户保护-用户组保护一键开启关闭-->
        $("#account_prot_openall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'account_prot_openall'}, function(ret)
            {
                loadret(ret);
                var msg = '{"method":"accountProtect","param":[{"des":"","name":"","status":true,"type":0}],"type":"modifyStatus"}';
                EncryptMsg(msg);
            })
        });

        $("#account_prot_closeall").click(function()
        {
            $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'','obj':'account_prot_closeall'}, function(ret)
            {
                loadret(ret);
                var msg = '{"method":"accountProtect","param":[{"des":"","name":"","status":false,"type":0}],"type":"modifyStatus"}';
                EncryptMsg(msg);
            })
        });

        <!-- 异地登录-规则设置 -->
        $("#RemoteLogin_save").click(function()
        {
            var commonlogina = document.getElementById('city-picker3').value;
            var commonloginb = document.getElementById('city-picker32').value;
            var obj=document.getElementsByName('remotelogin');
            var remoteloginnotice = '';
            for(var i=0; i<obj.length; i++)
            {
                if(obj[i].checked)
                {
                    remoteloginnotice += obj[i].value + ';';
                }
            }

            $.get("../saveremotelogin",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'RemoteLogin','commonlogina':commonlogina,'commonloginb':commonloginb,'remoteloginnotice':remoteloginnotice}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存异地登录保护设置成功');
                     window.location.reload();
                }
                else
                {
                    alert('保存异地登录保护设置失败');
                }
            }
            )
        });

        <!--登录保护自定义规则，单个开关点击开启关闭-->
        {% for whitelist in whitelists %}
            $("#whitelist_{{whitelist.id}}").click(function()
            {
                console.log('{{whitelist.whitelist}}');
                var rulename = '{{whitelist.whitelist}}';
                $.get("../savesetting",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','type':'whitelist_prot','obj':rulename}, function(ret)
                {
                    loadret(ret);
                    var divclass = document.getElementById("whitelist_{{whitelist.id}}").className;
                    var status = false;
                    if('icon_open_a' == divclass)
                    {
                        status = true;
                    }
                    var Type = 0;
                    if('COMPUTER_NAME' == '{{whitelist.authmethod}}')
                    {
                        Type = 1;
                    }

                    var msg = '{"method":"LogoInProtect","param":[{"Id":"{{whitelist.whitelist}}","Type":{0},"Status":{1}}],"type":"modifyStatus"}'.format(Type,status);
                EncryptMsg(msg);
                })
            });
        {% endfor %}

        $("#session_verify_junior").click(function()
        {
            document.getElementById('session_verify_info').innerHTML='该模式对攻击判断较为宽松(正常情况下推荐)';
            document.getElementById('session_verify_juniora').value='初级模式';
            document.getElementById('session_verify_mode').style.display='none';
        });

        $("#session_verify_middle").click(function()
        {
            document.getElementById('session_verify_info').innerHTML='该模式对所有访问都会自动验证(网站处于受间歇性攻击情况下推荐)';
            document.getElementById('session_verify_juniora').value='中级模式';
            document.getElementById('session_verify_mode').style.display='none';
        });

        $("#session_verify_high").click(function()
        {
            document.getElementById('session_verify_info').innerHTML='该模式对所有访问都会手动点击验证(网站长期处于受长期攻击的情况下推荐)';
            document.getElementById('session_verify_juniora').value='高级模式';
            document.getElementById('session_verify_mode').style.display='none';
        });


        <!-- ARP防火墙 保存、恢复默认规则 -->
        $("#ARPfirwalll_savechange").click(function()
        {
            var obj=document.getElementsByName('ARPfirwall_selectrule');
            var selectARPfirwall="";
            var checknum= 0;
            var m_LocalArp = false;
            var m_Ipconflict = false;
            var m_LanSteal = false;
            var mode = 'auto';

            var ip = document.getElementById('localip').value;
            if('' == checkisIp(ip))
            {
                alert("本地IP地址格式错误");
                return;
            }
            var mac = document.getElementById('localmac').value;
            if(false == checkisMac(mac))
            {
                alert("本地Mac地址格式错误");
                return;
            }
            var gatewayip = document.getElementById('gatewayip').value;
            if('' == checkisIp(gatewayip))
            {
                alert("网关IP地址格式错误");
                return;
            }
            var gatewaymac = document.getElementById('gatewaymac').value;
            if(false == checkisMac(gatewaymac))
            {
                alert("网关Mac地址格式错误");
                return;
            }

            for(var i=0; i<obj.length; i++)
            {
                if(obj[i].checked)
                {
                    selectARPfirwall += obj[i].value + ';';
                }
            }

            if(-1 != selectARPfirwall.indexOf("InterceptLocalARPAttacks"))
            {
                m_LocalArp = true;
            }

            if(-1 != selectARPfirwall.indexOf("InterceptIPConflict"))
            {
                m_Ipconflict = true;
            }
            if(-1 != selectARPfirwall.indexOf("LANStealth"))
            {
                m_LanSteal = true;
            }

            if(-1 != selectARPfirwall.indexOf("manu"))
            {
                mode = 'manu';
            }

			SaveCustomizeGateway();

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'ARPfirwall','set':selectARPfirwall,'ip':ip,'mac':mac,'gatewayip':gatewayip,'gatewaymac':gatewaymac}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存ARP防火墙的设置成功');
                    var msg = '{"method":"ARPFireWall","mode":"{mode}","param":{"m_LocalArp":{m_LocalArp},"m_Ipconflict":{m_Ipconflict},"m_LanSteal":{m_LanSteal}},"type":"modify"}'.format({m_LocalArp:m_LocalArp,mode:mode,m_Ipconflict:m_Ipconflict,m_LanSteal:m_LanSteal});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存ARP防火墙的设置失败');
                }
            }
            )
        });

        $("#ARPfirwall_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'ARPfirwall'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复ARP防火墙的默认设置成功');
					var msg = '{"method":"ARPFireWall","mode":"auto","param":{"m_LocalArp":false,"m_Ipconflict":false,"m_LanSteal":false},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复ARP防火墙的默认设置失败');
                }
            }
            )
        });

        <!--检查网络防火墙各模块设置的值-->
        function checkWebFireWallValue(val)
        {
            if(0 == val || '' ==val)
            {
                return false;
            }
            return true;
        }

        <!-- DDoS防火墙 保存、恢复默认规则 -->
        $("#DDosfirwall_savechange").click(function()
        {
            var SYNAttack_Seconds = document.getElementById('synattack_sec').value;
            var SYNAttack_times = document.getElementById('synattack_time').value;
            var ScanAttack_Seconds = document.getElementById('scanattack_sec').value;
            var ScanAttack_times = document.getElementById('scanattack_time').value;
            var FlowAttack_ICMP_Seconds = document.getElementById('flowattack_sec').value;
            var FlowAttack_ICMP_times = document.getElementById('flowattack_time').value;
            var FlowAttack_UDP_Seconds = document.getElementById('UDPbag_sec').value;
            var FlowAttack_UDP_times = document.getElementById('UDPbag_time').value;
            var DDoS_IPFreezeTime = document.getElementById('DDoS_IPFreezeTime').value;

            if(!checkWebFireWallValue(SYNAttack_Seconds) || !checkWebFireWallValue(SYNAttack_times) || !checkWebFireWallValue(ScanAttack_Seconds) || !checkWebFireWallValue(ScanAttack_times) || !checkWebFireWallValue(FlowAttack_ICMP_Seconds) || !checkWebFireWallValue(FlowAttack_ICMP_times) || !checkWebFireWallValue(FlowAttack_UDP_Seconds) || !checkWebFireWallValue(FlowAttack_UDP_times) || !checkWebFireWallValue(DDoS_IPFreezeTime) )
            {
                alert("DDoS防火墙设置值不合法");
                return;
            }


            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'DDosfirwall','SYNAttack_Seconds':SYNAttack_Seconds,'SYNAttack_times':SYNAttack_times,'ScanAttack_Seconds':ScanAttack_Seconds,'ScanAttack_times':ScanAttack_times,'FlowAttack_ICMP_Seconds':FlowAttack_ICMP_Seconds,'FlowAttack_ICMP_times':FlowAttack_ICMP_times,'FlowAttack_UDP_Seconds':FlowAttack_UDP_Seconds,'FlowAttack_UDP_times':FlowAttack_UDP_times,'DDoS_IPFreezeTime':DDoS_IPFreezeTime}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存DDoS防火墙的设置成功');
                    var msg = '{"method":"DDosFireWall","param":{"nSynSec":{nSynSec},"nSynConut":{nSynConut},"nScanSec":{nScanSec},"nScanConut":{nScanConut},"nStreamICMPSec":{nStreamICMPSec},"nStreamICMPSConut":{nStreamICMPSConut},"nStreamUDPSec":{nStreamUDPSec},"nStreamUDPSConut":{nStreamUDPSConut},"nFrostMin":{nFrostMin}},"type":"modify"}'.format({nSynSec:SYNAttack_Seconds, nSynConut:SYNAttack_times,nScanSec:ScanAttack_Seconds,nScanConut:ScanAttack_times,nStreamICMPSec:FlowAttack_ICMP_Seconds,nStreamICMPSConut:FlowAttack_ICMP_times,nStreamUDPSec:FlowAttack_UDP_Seconds,nStreamUDPSConut:FlowAttack_UDP_times,nFrostMin:DDoS_IPFreezeTime});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存DDoS防火墙的设置失败');
                }
            }
            )
        });

        $("#DDosfirwall_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'DDosfirwall'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复DDos防火墙的默认设置成功');
                    var msg = '{"method":"DDosFireWall","param":{"nSynSec":10,"nSynConut":200,"nScanSec":10,"nScanConut":50,"nStreamICMPSec":10,"nStreamICMPSConut":500,"nStreamUDPSec":10,"nStreamUDPSConut":2000,"nFrostMin":10},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复DDos防火墙的默认设置失败');
                }
            }
            )
        });

        <!--判断输入的端口值是否正确-->
        function checkPortVar(portval)
        {
            var limit = 10;
            var strport = '';
            var portarray = portval.split(";");
            if(';' == portval.charAt(portval.length - 1) )
            {
                portarray.pop();
            }

            if(portarray.length > limit)
            {
                return false;
            }

            for(var i=0;i<portarray.length;i++)
            {
                var port = portarray[i].replace(/;/g,'');
                var numport = new Number(port);

                if(numport>65535 || numport <1)
                {
                    return '';
                }
                strport += numport.toString() + ';';
            }
            return strport;
        }

        <!-- Web防火墙： -->
        $("#Web_firwall_savechange").click(function()
        {
            var WebFirewall_Seconds = document.getElementById('WebFirewall_Seconds').value;
            var WebFirewall_Times = document.getElementById('WebFirewall_Times').value;
            var WebFirewall_IPFreezeTime = document.getElementById('WebFirewall_IPFreezeTime').value;
            <!--var WebFirewall_IPAllowTime = document.getElementById('WebFirewall_IPAllowTime').value;-->
            var WebFirewall_IPAllowTime = 1;

            var WebFirewal_VerifySessionOn = true;
            var WebFirewal_VerifySessionLevel = 0;
            <!---->
            <!--var Levelvalue = document.getElementById('session_verify_juniora').value;-->
            <!--if( '初级模式'== Levelvalue )-->
            <!--{-->
                <!--WebFirewal_VerifySessionLevel = 0;-->
            <!--}-->
            <!--else if( '中级模式'== Levelvalue )-->
            <!--{-->
                <!--WebFirewal_VerifySessionLevel = 1;-->
            <!--}-->
            <!--else if( '高级模式'== Levelvalue )-->
            <!--{-->
                <!--WebFirewal_VerifySessionLevel = 2;-->
            <!--}        -->

            var WebFirewal_ProtPort = document.getElementById('WebFirewal_ProtPort').value;
            var WebFirewal_AgentMaxIPs = document.getElementById('WebFirewal_AgentMaxIPs').value;
            var WebFirewal_AgentTime = document.getElementById('WebFirewal_AgentTime').value;

            if(-1 != WebFirewal_ProtPort.indexOf(';;'))
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }

            if(checkPortDup(WebFirewal_ProtPort))
            {
                alert("端口值内容重复");
                return;
            }

            WebFirewal_ProtPort = checkPortVar(WebFirewal_ProtPort);
            if(!WebFirewal_ProtPort)
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }

            if(!checkWebFireWallValue(WebFirewall_Seconds) || !checkWebFireWallValue(WebFirewall_Times) || !checkWebFireWallValue(WebFirewall_IPFreezeTime) || !checkWebFireWallValue(WebFirewall_IPAllowTime) || '' == WebFirewal_AgentMaxIPs || !checkWebFireWallValue(WebFirewal_AgentTime) )
            {
                alert("Web防火墙设置值不合法");
                return;
            }

            if(WebFirewal_AgentTime<30 || WebFirewal_AgentTime>1000)
            {
                alert("Web防火墙设置值不合法");
                return;
            }

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'Web_firwall','WebFirewall_Seconds':WebFirewall_Seconds,'WebFirewall_Times':WebFirewall_Times,'WebFirewall_IPFreezeTime':WebFirewall_IPFreezeTime,'WebFirewall_IPAllowTime':WebFirewall_IPAllowTime,'WebFirewal_ProtPort':WebFirewal_ProtPort,'WebFirewal_VerifySessionOn':WebFirewal_VerifySessionOn,'WebFirewal_VerifySessionLevel':WebFirewal_VerifySessionLevel,'WebFirewal_AgentMaxIPs':WebFirewal_AgentMaxIPs,'WebFirewal_AgentTime':WebFirewal_AgentTime}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存Web防火墙的设置成功');
                    var msg = '{"method":"WebFireWall","param":{"nSec":{0},"nConut": {1},"nFrostMin": {2},"nCheckUserMin": {3},"nModuleType": {4},"nProt": "{5}","wcUrlPath": "{6}","nProxyIPNums": {7},"nProxyTimes": {8}},"type":"modify"}'.format(WebFirewall_Seconds,WebFirewall_Times,WebFirewall_IPFreezeTime,WebFirewall_IPAllowTime,WebFirewal_VerifySessionLevel,WebFirewal_ProtPort,"",WebFirewal_AgentMaxIPs,WebFirewal_AgentTime);
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存Web防火墙的设置失败');
                }
            }
            )
        });

        $("#Web_firwall_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'Web_firwall'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复Web防火墙的默认设置成功');
                    var msg = '{"method":"WebFireWall","param":{"nSec":10,"nConut": 300,"nFrostMin": 10,"nCheckUserMin": 10,"nModuleType": 0,"nProt": "80","wcUrlPath": "","nProxyIPNums": 30,"nProxyTimes": 30},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复Web防火墙的默认设置失败');
                }
            }
            )
        });

        <!--检测是否端口重复-->
        function checkPortDup(portstr)
        {
            var ports = portstr.split(';');
            var sortports = ports.sort();

            for(var i = 0; i < sortports.length - 1; i++)
            {
                if (sortports[i] == sortports[i+1])
                {
                   return true;
                }
            }
            return false;
        }

        <!-- FTP防暴力破解： -->
        $("#FTP_avoidviolence_savechange").click(function()
        {
            var FTP_Seconds = document.getElementById('FTP_avoidviolence_sec').value;
            var FTP_Times = document.getElementById('FTP_avoidviolence_time').value;
            var FTP_IPFreezeTime = document.getElementById('FTP_avoidviolence_IPFreezeTime').value;
            var FTP_ProtPort = document.getElementById('FTP_avoidviolence_protpoct').value;

			if(-1 != FTP_ProtPort.indexOf(';;'))
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }


            if(checkPortDup(FTP_ProtPort))
            {
                alert("端口值内容重复");
                return;
            }

			FTP_ProtPort = checkPortVar(FTP_ProtPort);
            if(!FTP_ProtPort)
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }

            if(!checkWebFireWallValue(FTP_Seconds) || !checkWebFireWallValue(FTP_Times) || !checkWebFireWallValue(FTP_IPFreezeTime) || !checkWebFireWallValue(FTP_ProtPort) )
            {
                alert("FTP防暴力破解设置值不合法");
                return;
            }

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'FTP_avoidviolence','FTP_Seconds':FTP_Seconds,'FTP_Times':FTP_Times,'FTP_IPFreezeTime':FTP_IPFreezeTime,'FTP_ProtPort':FTP_ProtPort}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存FTP防暴力破解的设置成功');
                    var msg = '{"method":"FTPProtect","param":{"nSec":{nSec},"nConut":{nConut},"nFrostMin":{nFrostMin},"nProt":"{nProt}"},"type":"modify"}'.format({nSec:FTP_Seconds, nConut:FTP_Times,nFrostMin:FTP_IPFreezeTime,nProt:FTP_ProtPort});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存FTP防暴力破解的设置失败');
                }
            }
            )
        });

        $("#FTP_avoidviolence_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'FTP_avoidviolence'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复FTP防暴力破解的默认设置成功');
                    var msg = '{"method":"FTPProtect","param":{"nSec":60,"nConut":10,"nFrostMin":10,"nProt":"21"},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复FTP防暴力破解的默认设置失败');
                }
            }
            )
        });

        <!-- 远程桌面防暴力破解： -->
        $("#ReDesktop_avoidviolence_savechange").click(function()
        {
            var RemoteDesktop_Seconds = document.getElementById('ReDesktop_avoidviolence_sec').value;
            var RemoteDesktop_Times = document.getElementById('ReDesktop_avoidviolence_time').value;
            var RemoteDesktop_IPFreezeTime = document.getElementById('ReDesktop_IPFreezeTime').value;

            if(!checkWebFireWallValue(RemoteDesktop_Seconds) || !checkWebFireWallValue(RemoteDesktop_Times) || !checkWebFireWallValue(RemoteDesktop_IPFreezeTime))
            {
                alert("远程桌面防暴力破解设置值不合法");
                return;
            }

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'RemoteDesktop','RemoteDesktop_Seconds':RemoteDesktop_Seconds,'RemoteDesktop_Times':RemoteDesktop_Times,'RemoteDesktop_IPFreezeTime':RemoteDesktop_IPFreezeTime}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存远程桌面防暴力破解的设置成功');
                    var msg = '{"method":"RemoteProtect","param":{"nSec":{nSec},"nConut":{nConut},"nFrostMin":{nFrostMin},"nProt":{nProt}},"type":"modify"}'.format({nSec:RemoteDesktop_Seconds, nConut:RemoteDesktop_Times,nFrostMin:RemoteDesktop_IPFreezeTime,nProt:0});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存远程桌面防暴力破解的设置失败');
                }
            }
            )
        });

        $("#ReDesktop_avoidviolence_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'RemoteDesktop'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复远程桌面防暴力破解的默认设置成功');
                    var msg = '{"method":"RemoteProtect","param":{"nSec":60,"nConut":10,"nFrostMin":10,"nProt":0},"type":"modify"}'
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复远程桌面防暴力破解的默认设置失败');
                }
            }
            )
        });

        <!-- MySQL防暴力破解 -->
        $("#MySQL_avoidviolence_savechange").click(function()
        {
            var MySqlDB_Seconds = document.getElementById('MySqlDB_Seconds').value;
            var MySqlDB_Times = document.getElementById('MySqlDB_Times').value;
            var MySqlDB_IPFreezeTime = document.getElementById('MySqlDB_IPFreezeTime').value;
            var MySqlDB_ProtPort = document.getElementById('MySqlDB_ProtPort').value;

			if(-1 != MySqlDB_ProtPort.indexOf(';;'))
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }

            if(checkPortDup(MySqlDB_ProtPort))
            {
                alert("端口值内容重复");
                return;
            }

			MySqlDB_ProtPort = checkPortVar(MySqlDB_ProtPort);
            if(!checkPortVar(MySqlDB_ProtPort))
            {
                alert("保护端口设置值格式或者数值大小错误");
                return;
            }

            if(!checkWebFireWallValue(MySqlDB_Seconds) || !checkWebFireWallValue(MySqlDB_Times) || !checkWebFireWallValue(MySqlDB_IPFreezeTime) || !checkWebFireWallValue(MySqlDB_ProtPort))
            {
                alert("MySQL防暴力破解设置值不合法");
                return;
            }

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'MySqlDB','MySqlDB_Seconds':MySqlDB_Seconds,'MySqlDB_Times':MySqlDB_Times,'MySqlDB_IPFreezeTime':MySqlDB_IPFreezeTime,'MySqlDB_ProtPort':MySqlDB_ProtPort}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存MySQL防暴力的设置成功');
                    var msg = '{"method":"MySQLProtect","param":{"nSec":{nSec},"nConut":{nConut},"nFrostMin":{nFrostMin},"nProt":"{nProt}"},"type":"modify"}'.format({nSec:MySqlDB_Seconds, nConut:MySqlDB_Times,nFrostMin:MySqlDB_IPFreezeTime,nProt:MySqlDB_ProtPort});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存MySQL防暴力的设置失败');
                }
            }
            )
        });

        $("#MySQL_avoidviolence_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'MySqlDB'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复MySQL防暴力的默认设置成功');
                    var msg = '{"method":"MySQLProtect","param":{"nSec":60,"nConut":10,"nFrostMin":10,"nProt":"3306"},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复MySQL防暴力的默认设置失败');
                }
            }
            )
        });

        <!-- MSSQL防暴力破解 -->
        $("#MSSQL_avoidviolence_savechange").click(function()
        {
            var MSSQLDB_Seconds = document.getElementById('MSSqlDB_Seconds').value;
            var MSSQLDB_Times = document.getElementById('MSSqlDB_Times').value;
            var MSSQLDB_IPFreezeTime = document.getElementById('MSSqlDB_IPFreezeTime').value;

            if(!checkWebFireWallValue(MSSQLDB_Seconds) || !checkWebFireWallValue(MSSQLDB_Times) || !checkWebFireWallValue(MSSQLDB_IPFreezeTime))
            {
                alert("MSSQL防暴力破解设置值不合法");
                return;
            }

            $.get("../savenetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'MSSQLDB','MSSQLDB_Seconds':MSSQLDB_Seconds,'MSSQLDB_Times':MSSQLDB_Times,'MSSQLDB_IPFreezeTime':MSSQLDB_IPFreezeTime}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('保存MSSQL防暴力的设置成功');
                    var msg = '{"method":"MSSQLProtect","param":{"nSec":{nSec},"nConut":{nConut},"nFrostMin":{nFrostMin},"nProt":{nProt}},"type":"modify"}'.format({nSec:MSSQLDB_Seconds, nConut:MSSQLDB_Times,nFrostMin:MSSQLDB_IPFreezeTime,nProt:0});
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('保存MSSQL防暴力的设置失败');
                }
            }
            )
        });

        $("#MSSQL_avoidviolence_reset").click(function()
        {
            $.get("../resetnetfirewall",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','obj':'MSSQLDB'}, function(ret)
            {
                if(ret == 'success')
                {
                    alert('恢复MSSQL防暴力的默认设置成功');
                    var msg = '{"method":"MSSQLProtect","param":{"nSec":60,"nConut":10,"nFrostMin":10,"nProt":0},"type":"modify"}';
                    EncryptMsg(msg,true);
                }
                else
                {
                    alert('恢复MSSQL防暴力的默认设置失败');
                }
            }
            )
        });
    });



    function loadret(ret)
    {
        var retvalue = ret.replace('{', '');

        retvalue = retvalue.replace(/"/g, '');
        retvalue = retvalue.replace('}', '');
        var retarray = retvalue.split(",");
        for(var i=0;i<retarray.length;i++)
        {
            var feature = retarray[i];
            if('' == feature)
            {
                continue;
            }

            var elementid =  (feature.split(":"))[0];
            var featureid = "#" + elementid;
            var featurestatus = (feature.split(":"))[1];

            if(1 == featurestatus)
            {
                $(featureid).removeClass("icon_close_a");
                $(featureid).addClass("icon_open_a");
            }else
            {
                $(featureid).removeClass("icon_open_a");
                $(featureid).addClass("icon_close_a");;
            }
        }
    }

    function sendMessage() {
        var msg = document.getElementById("inputText").value;
        if ( websocket != null )
        {
            document.getElementById("inputText").value = "";
            var msg = '{"method": "sysfirewallmaincfig", "param": {"ACCOUNT": true} }';
            EncryptMsg(msg);
            <!--console.log( "string sent :", '"'+msg+'"' );-->
        }
    }

    function debug(message) {
        <!-- alert("收到消息:\n" + message); -->
    }

    <!--websocket与客户端保持同步功能相关-->
    var wsUri = "ws://{{server.serverip}}:8000";
    var websocket = null;

    function initWebSocket()
    {
        try
        {
            if (typeof MozWebSocket == 'function')
            {
                WebSocket = MozWebSocket;
            }

            if ( websocket && websocket.readyState == 1 )
            {
                websocket.close();
            }

            websocket = new WebSocket( wsUri );
            websocket.onopen = function (evt)
            {
                console.log("CONNECTED");
            };

            websocket.onclose = function (evt)
            {
                console.log("DISCONNECTED");
                <!--window.location.href = "{% url 'servermanage' %}";-->
            };
            websocket.onmessage = function (evt)
            {
                console.log( "Message received :", evt.data );
                debug( evt.data );
            };
            websocket.onerror = function (evt)
            {
                debug('ERROR: ' + evt.data);
            };
        } catch (exception)
        {
            debug('ERROR: ' + exception);
        }
    }

    function stopWebSocket()
    {
        if (websocket)
        {
            websocket.close();
        }
    }

    initWebSocket();

     function addipsegment(startip,endip)
    {
        var tab = document.getElementById("tbipsegment");
        var trnum=tab.getElementsByTagName("tr").length;
        if(trnum>9)
        {
            alert("不能添加更多的IP地址段了");
            return;
        }

        var tr = document.createElement("tr");
        var td1 = document.createElement("td");
        var td2 = document.createElement("td");
        var td3 = document.createElement("td");

        var startiptmp = '';
        if(startip)
        {
            startiptmp = startip;
        }
        else
        {
            startiptmp='';
        }

        var endiptmp = '';
        if(endip)
        {
            endiptmp = endip;
        }
        else
        {
            endiptmp='';
        }


        td1.innerHTML = "IP地址段：<input maxlength='15' style='width: 130px;margin-left: 0;' name='startip' placeholder='192.168.1.1' value='{0}' onblur='checkthisIP(this);'>-<input maxlength='15' style='width: 130px;' name='endip' placeholder='192.168.1.1' value='{1}' onblur='checkthisIP(this);'>".format(startiptmp,endiptmp);

        if(0 == trnum)
        {
            td2.innerHTML = "<input type='button' onclick='addipsegment();' style='width: 25px;border:0;margin: 0; background:url({% static "images/addbtn.png" %}) no-repeat'>";
        }
        else
        {
            td2.innerHTML = "<input type='button' onclick='delportsegment(this);' style='width: 25px;border:0;margin: 0; background:url({% static "images/delbtn.png" %}) no-repeat'>";
        }



        tr.appendChild(td1);
        tr.appendChild(td2);
        <!--tr.appendChild(td3);-->

        tab.appendChild(tr);
   }

   <!-- 判断IP是否符合格式 -->
    function checkthisIP(ipInput)
    {
        var ip = ipInput.value;
        if('' == checkisIp(ip))
        {
            ipInput.value = '';
            ipInput.placeholder = '192.168.1.1';
        }
    }

	<!-- 判断是否是正确的端口格式 -->
	function checkthisPort(portInput)
    {
        var port = portInput.value;
        var portnum = parseInt(port);
		if((port!='')&&(-1!=port.indexOf('.')||portnum>65535||portnum<0))
		{
            alert("端口不合法");
			portInput.value = '';
		}
    }

	<!-- 判断输入的Ip是否符合例外IP格式 -->
    function checkthisExceptIP(ipInput)
    {
        var ip = ipInput.value;
        var iparray = ip.split(';');

        for(var i=0;i<iparray.length;i++)
        {
            if('' == checkisIp(iparray[i]) && '' != iparray[i] )
            {
                ipInput.value = '';
                ipInput.placeholder = '输入例外IP地址，多个地址用英文分号隔开';
            }
        }
    }

	<!-- 判断是否是MAC地址格式 -->
    function checkthisMac(macinput)
    {
        var mac = macinput.value;
        var temp = /[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}-[A-Fa-f0-9]{2}/;
        if (!temp.test(mac))
        {
            macinput.value = "";
            macinput.placeholder = '00-15-44-14-14-14';
        }
    }

    function delportsegment(ipsegment)
    {
        var tab=document.getElementById("tbipsegment");
        var tr=tab.getElementsByTagName("tr");

        ipsegment.parentElement.parentElement.parentElement.removeChild(ipsegment.parentElement.parentElement);
        if(0 == tr.length)
        {
            addipsegment();
        }
    }

    <!--根据IP获取城市名字-->
    function checkIP()
    {
        var city = remote_ip_info['city'];
        alert(city)
    }

    <!--显示超级黑白名单的备注-->
    function loadsuperlistremark()
    {
        {% for superlist in superlists %}
            var singleip = '{{superlist.addr}}';
            var newremark = '';
            if('None' != singleip)
            {
                newremark = '{{superlist.ipremark}}';
            }
            else
            {
                newremark = '{{superlist.ipsremark}}';
            }

            newremark = newremark.replace(/_@/g, '\r\n');
            document.getElementById('super_remark_{{superlist.id}}').value  = newremark;
            document.getElementById('super_remark_{{superlist.id}}').title  = newremark;
        {% endfor %}
    }

    <!--加密要发送的数据-->
    function EncryptMsg(msg,reload)
    {
        if(true !=reload)
        {
            reload = false;
        }

        $.get("../encryptmsg",{'msg':msg}, function(ret)
        {
            <!--if(1 == websocket.readyState)-->
            <!--{-->
                <!--websocket.send(ret);-->
			<!--}-->
            <!--else-->
            <!--{-->
                <!--alert("和客户端断开连接，无法同步设置到客户端，即将跳转到设备管理页面");-->
                <!--window.location.href = "{% url 'servermanage' %}";-->
            <!--}-->

			<!--if(reload)-->
			<!--{-->
				<!--window.location.reload();-->
			<!--}-->
        }
        )
    }

    <!--移动IP拦截监控-->
    function changeInterceptType(type)
    {
        var selectinterceptipid='';
        var selectintercept= '[';

        var name = '';
        if( 'ALLOWED_IP' == type)
        {
            name = 'selectblockip';
        }
        else if('BLOCK_IP' == type)
        {
            name = 'selectallowip';
        }

        var obj=document.getElementsByName(name);

        for(var i=0; i<obj.length; i++)
        {
            if(obj[i].checked)
            {
                selectinterceptipid += obj[i].value + ';';

                {% for interceptip in interceptips %}
                    if(obj[i].value == {{interceptip.id}})
                    {
                        if('[' != selectintercept)
                        {
                            selectintercept += ',';
                        }
                        selectintercept += '"{{interceptip.ip}}"';
                    }
                {% endfor %}
            }
        }

        selectintercept += ']';


        if('' == selectinterceptipid)
        {
            alert('至少勾选一条IP记录!');
            return;
        }

        $.get("../changeinterceptip",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}' ,'selectinterceptipid':selectinterceptipid,'type':type},function(ret)
        {
            if(ret == 'success')
            {
                alert('移动IP拦截成功');
                <!--var msg='{"method": "process","param": {0},"Type": "delete"}'.format(selectedprocess);-->
                <!--EncryptMsg(msg);-->
                window.location.reload();
            }
            else
            {
                alert('移动IP拦截失败');
            }
        }
        )
    }

    window.onload=function()
    {
        setInterval('countDown()',1000);
    }

    function countDown()
    {
        {% for interceptip in interceptips %}
            $.get("../getremaintime",{'strategyid':'{{strategy.id}}','serverid':'{{server.id}}','interceptipid':'{{interceptip.id}}'}, function(ret)
            {
                var obj = eval('(' + ret + ')');
                var id = 'num_' +  obj.id;
                var time=document.getElementById(id);
                time.innerHTML = parseInt(obj.remain);
                if(0 == obj.remain)
                {
                    <!--window.location.reload();-->
                }
            })

        {% endfor %}
    }
{% endblock %}

{% block content %}
    <div class="contentsettingzk" >
        <div class="setleft">
            <div class="settingbtn" ><a style="color: rgb(255, 255, 255);" href="../singleserver/?serverid={{server.id}}">仪表盘</a></div>
            <div class="settingbtn" style="background: rgb(58, 90, 136);"><a style="color: rgb(255, 255, 255);" href="javascript:;">设置中心</a></div>
        </div>
        <div style="float:right;height:100%;width:84%; background:#f3f7f9;">
            <div style="background:#ffffff;height:85%;margin:20px;">
                <div style="padding-top:10px;border-bottom: 1px rgb(230, 189, 189) solid;padding-bottom:10px;">
                    <div id="sysfirewall" style="height:40px;margin:10px;background: rgba(202, 151, 83, 0.1803921568627451);padding-top:1px;">
                        <h4 style="padding-left:15px;color:#0000008f;">系统防火墙</h4>
                    </div>
                    <div style="height:260px;background:#f3f7f9;margin-left: 10px;margin-right: 10px;">
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">文件保护：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="file_prot"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="file_prot_a" onclick="ShowDiv('file_prot_protect_set','fade','file_prot')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">注册表保护：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="registry_prot"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="registry_prot_a" onclick="ShowDiv('registry_prot_protect_set','fade','registry_prot')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">账户保护：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="account_prot"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="account_prot_a" onclick="ShowDiv('account_prot_protect_set','fade','account_prot')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">进程行为控制：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="process_behavior"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="process_behavior_a" onclick="ShowDiv('process_behavior_protect_set','fade','process_behavior')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">登录保护:</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="whitelist_access_control"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="whitelist_access_control_a" onclick="ShowDiv('whitelist_access_control_protect_set','fade','whitelist_access_control')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">外围控制:</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="outside_control"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="outside_control_a" onclick="ShowDiv('outside_control_protect_set','fade','outside_control')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <!--<ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">-->
                            <!--<li style="border: none;width: 200px;">应用程序控制:</li>-->
                            <!--<li style="border: none;width: 200px;">-->
                                <!--<form action="." method="get">-->
                                    <!--<div id="app_control"></div>-->
                                <!--</form>-->
                            <!--</li>-->
                            <!--<li style="border: none;width: 200px;"><a id="app_control_a" onclick="ShowDiv('app_control_protect_set','fade')" href="javascript:;">规则设置</a></li>-->
                        <!--</ul>-->
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">异地登录提醒:</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="remote_login_remind"></div>
                                </form>
                            </li>
                            <!-- <li style="border: none;width: 200px;">规则设置</li> -->
                            <li style="border: none;width: 200px;"><a id="remote_login_remind_a" onclick="RemoteLoginSet();ShowDiv('remotelogin_protect_set','fade','whitelist_access_control')" href="javascript:;">规则设置</a></li>
                        </ul>
                    </div>
                    <div id="file_prot_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">文件保护-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="checkadddiv('file_prot_protect_add');CloseDiv('file_prot_protect_set','fade');"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                                <table width="100%" style="line-height: 50px;">
                                    <tr id="type_0_1" onclick="return openOrCloseAlarmType(this.id);" class="ruletypehead">
                                        <td class="border_dotted_bottom" style="cursor:pointer;" colspan="3">
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 16px;margin-left: 10px;"></i>
                                            <span style="font-size: 20px;padding-top: 12px;">系统保护规则</span>
                                            <span style="font-size: 10px;padding-top: 12px;">保护文件免被篡改和删除，雷盾推荐并定期更新，不允许修改。</span>
                                        </td>
                                    </tr>
                                    <tr id="type_0_1_1" class="rulelisthead">
                                        <td style="padding-left:50px;">
                                            规则名称
                                        </td>
                                        <td>
                                            路径
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                    </tr>
                                    {% for sysrule in file_prot_sysrules %}
                                        <tr id="type_0_1_{{sysrule.id}}" class="rulelist">
                                            <td style="padding-left:50px;">
                                                [系统]{{sysrule.rulename}}
                                            </td>
                                            <td>
                                                {{sysrule.rulepath}}
                                            </td>
                                            <td>
                                                <form action="." method="get">
                                                    <div id="sysruleid_{{sysrule.id}}"></div>
                                                </form>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    <tr id="type_0_1_4" class="rulelistbtn">
                                        <td colspan="3" style="line-height: 20px;">
                                            <div class="setbutton">
                                                <button id="file_prot_openallsys">一键开启</button>
                                                <button id="file_prot_closeallsys">全部关闭</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table width="100%" style="line-height: 50px;">
                                    <tr id="type_fileprot_2"  onclick="return openOrCloseAlarmType(this.id);" class="ruletypehead">
                                        <td class="border_dotted_bottom" style="cursor:pointer;" colspan="4">
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 16px;margin-left: 10px;"></i>
                                            <span style="font-size: 20px;padding-top: 12px;">自定义保护规则</span>
                                            <span style="font-size: 10px;padding-top: 12px;">保护文件免被篡改和删除，支持用户按需设置。</span>
                                        </td>
                                    </tr>
                                    <tr id="type_fileprot_2_1" class="rulelisthead">
                                        <td style="padding-left:50px;"><div style=""><input id="controlAll" name="controlAll" type="checkbox"/> 全选</div></td>
                                        <td>
                                            规则名称
                                        </td>
                                        <td>
                                            路径
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                    </tr>
                                    {% for userrule in file_prot_userrules %}
                                    <tr id="type_fileprot_2_{{userrule.id}}" class="rulelist">
                                        <td style="padding-left:50px;"><input type="checkbox" name="file_prot_selectrule" value="{{userrule.id}}"></input></td>
                                        <td>
                                            <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{userrule.rulename}}" disabled="disabled" title="{{userrule.rulename}}">
                                        </td>
                                        <td>
                                            <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{userrule.rulepath}}" disabled="disabled" title="{{userrule.rulepath}}">
                                        </td>
                                        <td>
                                            <form action="." method="get">
                                                <div id="userruleid_{{userrule.id}}"></div>
                                            </form>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    <tr id="type_fileprot_2_btn" class="rulelistbtn">
                                        <td colspan="4">
                                            <div id="file_prot_button" class="setbutton">
                                                <button onclick="addrule('file_prot_');ShowDiv('file_prot_protect_add','fade','file_prot');document.getElementById('file_prot_titleid').innerHTML='增加文件保护规则';">增加</button>
                                                <button id="changerule" onclick="changerule('file_prot_');">修改</button>
                                                <button id="delrule" onclick="delselectrule('file_prot_');">删除</button>
                                                <button id="file_prot_openall">一键开启</button>
                                                <button id="file_prot_closeall">全部关闭</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                        </div>
                    </div>
                    <div id="file_prot_protect_add" class="white_content" style="top: 260px;left:950px;width:530px;height:380px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="file_prot_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">增加文件保护规则</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('file_prot_protect_add','fade');"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div class="addrule">
                            <div style="padding-top: 15px;">
                                <span>规则名称：</span>
                                <input id="file_prot_rule_name" maxlength="64" type="text" class="inputzk" style="width: 200px;padding: unset;" value="" />
                                <input id="file_prot_id" style="display:none;" value="">
                            </div>
                            <div>
                                <span>监控路径：</span>
                                <input id="file_prot_rule_path" type="text" maxlength="255" class="inputzk" style="width: 200px;padding: unset;" value="" />
                            </div>
                            <div>
                                <span>监控类型：</span>
                                <input type="checkbox" name="file_prot_ruletype" value="file_prot_file"/>文件
                                <input type="checkbox" name="file_prot_ruletype" style="margin-left: 20px;" value="file_prot_dir"/>文件夹
                            </div>
                            <div>
                                <span>禁止操作：</span>
                                <input type="checkbox" id="file_prot_norun" name="file_prot_trail" value="check_no_run"/>执行
                                <input type="checkbox" id="file_prot_nodel" name="file_prot_trail" style="margin-left: 20px;" value="check_no_del"/>删除
                                <input type="checkbox" id="file_prot_nocreate" name="file_prot_trail" style="margin-left: 20px;" value="check_no_create"/>创建
                                <input type="checkbox" id="file_prot_noread" name="file_prot_trail" style="margin-left: 20px;" value="check_no_read"/>读取
                                <input type="checkbox" id="file_prot_nowrite" name="file_prot_trail" style="margin-left: 20px;" value="check_no_write"/>写入
                            </div>
                        </div>
                        <div>
                            <p style="padding-left:20px;color:#141212ad;float:left;font-size: 15px;">高级规则设置</p>
                            <hr class="addrulehr">
                            <div class="tab">
                                 <div class="tab_menu">
                                     <ul>
                                         <li id="file_prot_allowfile" class="on"><a href="javascript:;">允许文件</a></li>
                                         <li id="file_prot_forbidfile"><a href="javascript:;">阻止文件</a></li>
                                         <li id="file_prot_allowextenname"><a href="javascript:;">允许扩展名</a></li>
                                         <li id="file_prot_forbidextenname"><a href="javascript:;">阻止扩展名</a></li>
                                         <li id="file_prot_processwhitelist"><a href="javascript:;">进程白名单</a></li>
                                         <li id="file_prot_processblacklist"><a href="javascript:;">进程黑名单</a></li>
                                     </ul>
                                 </div>
                                 <div id="file_prot_div"  class="tab_box">
                                     <div>
                                        <input id="file_prot_rule_content_0" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="允许 1、文件名/文件夹名；2、用'|'分割"/>
                                     </div>
                                     <div>
                                        <input id="file_prot_rule_content_1" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="禁止 1、文件名/文件夹名；2、用'|'分割"/>
                                     </div>
                                     <div>
                                        <input id="file_prot_rule_content_2" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="允许 用'|'分割扩展名"/>
                                     </div>
                                     <div>
                                        <input id="file_prot_rule_content_3" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="禁止 用'|'分割扩展名"/>
                                     </div>
                                     <div>
                                        <input id="file_prot_rule_content_4" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="白名单 用'|'分割进程名"/>
                                     </div>
                                     <div>
                                        <input id="file_prot_rule_content_5" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="黑名单 用'|'分割进程名"/>
                                     </div>
                                 </div>
                            </div>
                        </div>
                        <div>
                            <button id="addrulebtn" onclick="saveuserrule('file_prot_');CloseDiv('file_prot_protect_add','fade');" style="float: right;margin-right: 35px;margin-top:15px;width:75px;">保存</button>
                        </div>
                    </div>
                    <div id="registry_prot_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">注册表保护-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="checkadddiv('registry_prot_protect_add');CloseDiv('registry_prot_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                                <table width="100%" style="line-height: 50px;">
                                    <tr id="type_registry_1" onclick="return openOrCloseAlarmType(this.id);" class="ruletypehead">
                                        <td class="border_dotted_bottom" style="cursor:pointer;" colspan="3">
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 16px;margin-left: 10px;"></i>
                                            <span style="font-size: 20px;padding-top: 12px;">系统保护规则</span>
                                            <span style="font-size: 10px;padding-top: 12px;">保护注册表免被篡改和删除，雷盾推荐并定期更新，不允许修改。</span>
                                        </td>
                                    </tr>
                                    <tr id="type_registry_1_1" class="rulelisthead">
                                        <td style="padding-left:50px;">
                                            规则名称
                                        </td>
                                        <td>
                                            路径
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                    </tr>
                                    {% for sysrule in registry_prot_sysrules %}
                                        <tr id="type_registry_1_2" class="rulelist">
                                            <td style="padding-left:50px;">
                                                [系统]{{sysrule.rulename}}
                                            </td>
                                            <td>
                                                <input disabled="disabled" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;height: 40px;" value="{{sysrule.rulepath}}" title="{{sysrule.rulepath}}">
                                            </td>
                                            <td>
                                                <form action="." method="get">
                                                    <div id="sysruleid_{{sysrule.id}}"></div>
                                                </form>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    <tr id="type_registry_1_4" class="rulelistbtn">
                                        <td colspan="3" style="line-height:20px;">
                                            <div class="setbutton">
                                                <button id="registry_prot_openallsys">一键开启</button>
                                                <button id="registry_prot_closeallsys">全部关闭</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table width="100%" style="line-height: 50px;">
                                    <tr id="type_registry_2"  onclick="return openOrCloseAlarmType(this.id);" class="ruletypehead">
                                        <td class="border_dotted_bottom" style="cursor:pointer;" colspan="4">
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 16px;margin-left: 10px;"></i>
                                            <span style="font-size: 20px;padding-top: 12px;">自定义保护规则</span>
                                            <span style="font-size: 10px;padding-top: 12px;">保护注册表免被篡改和删除，支持用户按需设置。</span>
                                        </td>
                                    </tr>
                                    <tr id="type_registry_2_1" class="rulelisthead">
                                        <td style="padding-left:50px;"><div style=""><input id="registry_prot_controlAll" name="registry_prot_controlAll" type="checkbox"/> 全选</div></td>
                                        <td>
                                            规则名称
                                        </td>
                                        <td>
                                            路径
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                    </tr>
                                    {% for registry_prot_userrule in registry_prot_userrules %}
                                    <tr id="type_registry_2_{{userrule.id}}" class="rulelist">
                                        <td style="padding-left:50px;"><input type="checkbox" name="registry_prot_selectrule" value="{{registry_prot_userrule.id}}"></input></td>
                                        <td>
                                            <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{registry_prot_userrule.rulename}}" disabled="disabled" title="{{registry_prot_userrule.rulename}}">
                                        </td>
                                        <td>
                                            <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{registry_prot_userrule.rulepath}}" disabled="disabled" title="{{registry_prot_userrule.rulepath}}">
                                        </td>
                                        <td>
                                            <form action="." method="get">
                                                <div id="userruleid_{{registry_prot_userrule.id}}"></div>
                                            </form>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    <tr id="type_registry_2_btn" class="rulelistbtn">
                                        <td colspan="4">
                                            <div id="registry_prot_button"  class="setbutton">
                                                <button onclick="addrule('registry_prot_');ShowDiv('registry_prot_protect_add','fade','registry_prot');">增加</button>
                                                <button id="registry_prot_changerule" onclick="changerule('registry_prot_');">修改</button>
                                                <button id="registry_prot_delrule" onclick="delselectrule('registry_prot_');">删除</button>
                                                <button id="registry_prot_openall">一键开启</button>
                                                <button id="registry_prot_closeall">全部关闭</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                        </div>
                    </div>
                    <div id="registry_prot_protect_add" class="white_content" style="top: 260px;left:950px;width:530px;height:380px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="registry_prot_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">增加注册表保护规则</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('registry_prot_protect_add','fade');"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div class="addrule">
                            <div style="padding-top: 15px;">
                                <span>规则名称：</span>
                                <input id="registry_prot_rule_name" maxlength="64" type="text" class="inputzk" style="width: 200px;padding: unset;" value="" />
                                <input id="registry_prot_id" style="display:none;" value="">
                            </div>
                            <div>
                                <span>监控路径：</span>
                                <input id="registry_prot_rule_path" type="text" maxlength="255" class="inputzk" style="width: 200px;padding: unset;" value="" />
                            </div>
                            <div id="registryprot_type">
                                <span>监控类型：</span>
                                <input id="registry_prot_1" type="radio" name="registry_prot_ruletype" value="registry_prot_item"/>注册表项
                                <input id="registry_prot_2" type="radio" name="registry_prot_ruletype" style="margin-left: 20px;" value="registry_prot_value"/>注册表值
                            </div>
                            <div>
                                <span>禁止操作：</span>
                                <input type="checkbox" id="registry_prot_nodel" name="registry_prot_trail" value="check_no_del"/>删除
                                <input type="checkbox" id="registry_prot_nocreate" name="registry_prot_trail" style="margin-left: 20px;" value="check_no_create"/>创建
                                <input type="checkbox" id="registry_prot_nowrite" name="registry_prot_trail" style="margin-left: 20px;" value="check_no_write"/>写入
                            </div>
                        </div>
                        <div>
                            <p style="padding-left:20px;color:#141212ad;float:left;font-size: 15px;">高级规则设置</p>
                            <hr class="addrulehr">
                            <div class="tab">
                                 <div class="tab_menu" style="width: 160px;">
                                     <ul>
                                         <li id="registry_prot_processwhitelist" class="on"><a href="javascript:;">进程白名单</a></li>
                                         <li id="registry_prot_processblacklist"><a href="javascript:;">进程黑名单</a></li>
                                     </ul>
                                 </div>
                                 <div id="registry_prot_div" class="tab_box">
                                     <div>
                                        <input id="registry_prot_rule_content_0" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="进程白名单 '|'分割进程名，进程不受规则限制"/>
                                     </div>
                                     <div>
                                        <input id="registry_prot_rule_content_1" type="text" class="inputzk" maxlength="1280" style="width:100%;height:35px;" value="" placeholder="进程黑名单 '|'分割进程名，进程不受规则限制"/>
                                     </div>
                                 </div>
                            </div>
                        </div>
                        <div>
                            <button id="registry_prot_protect_addrulebtn" onclick="CloseDiv('registry_prot_protect_add','fade');saveuserrule('registry_prot_');" style="float: right;margin-right: 35px;margin-top:15px;width:75px;">保存</button>
                        </div>
                    </div>
                    <div id="account_prot_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">账户保护-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('account_prot_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_account_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 450px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">超级管理员保护</span>
                                        <span style="font-size: 10px;padding-top: 12px;">禁止修改管理员账户密码。</span>
                                    </td>
                                    <td class="border_dotted_bottom">
                                        <form action="." method="get">
                                            <div id="nochangadmin_pass"></div>
                                        </form>
                                    </td>
                                </tr>
                                <tr id="type_account_2" class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">用户组织保护</span>
                                        <span style="font-size: 10px;padding-top: 12px;">禁止黑客创建系统账号，阻止账号提权，请选择需要保护的用户组。</span>
                                    </td>
                                    <td class="border_dotted_bottom">
                                        <form action="." method="get">
                                            <div id="usergroup_prot"></div>
                                        </form>
                                    </td>
                                </tr>
                            </table>
                            <table width="100%" style="line-height: 50px;">
                                    <tr id="type_account_2_1" class="rulelisthead">
                                        <td style="padding-left:50px;" width="20%">
                                            用户组
                                        </td>
                                        <td width="60%">
                                            描述
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                    </tr>
                                    {%for usergroup in usergroups%}
                                    <tr id="type_account_2_{{usergroup.id}}" class="rulelist">
                                        <td style="padding-left:50px;">
                                            <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{usergroup.usergroup}}" disabled="disabled" title="{{usergroup.usergroup}}"/>
                                        </td>
                                        <td>
                                            <input type="text" class="inputzk" style="width: 100%;border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{usergroup.usergroupdes}}" disabled="disabled" title="{{usergroup.usergroupdes}}"/>
                                        </td>
                                        <td>
                                            <form action="." method="get">
                                                <div id="accountprot_{{usergroup.id}}"></div>
                                            </form>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    <tr id="type_account_2_btn" class="rulelistbtn">
                                        <td colspan="3">
                                            <div id="account_prot_button"  class="setbutton">
                                                <button id="account_prot_openall">一键开启</button>
                                                <button id="account_prot_closeall">全部关闭</button>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                        </div>
                    </div>
                    <div id="process_behavior_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">进程行为控制-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="checkadddiv('process_behavior_protect_add');CloseDiv('process_behavior_protect_set','fade');"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_process_behavior_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">禁止进程非法操作</span>
                                        <span style="font-size: 10px;padding-top: 12px;">通过禁止进程的非法操作来全面防黑防入侵。</span>
                                    </td>
                                    <!--<td style="line-height: 20px;font-size: 17px;">-->
                                        <!--<button id="getprocess">获取主要进程</button>-->
                                    <!--</td>-->
                                </tr>
                                <tr id="type_process_behavior_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;"><div style=""><input id="process_behavior_controlAll" name="process_behavior_controlAll" type="checkbox"/> 全选</div></td>
                                    <td style="padding-left:50px;">
                                        进程名
                                    </td>
                                    <td>
                                        路径
                                    </td>
                                    <td>
                                        防护策略
                                    </td>
                                </tr>
                                {% for importprocess in importprocesses %}
                                <tr id="type_process_behavior_2_{{importprocess.id}}" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox" name="process_behavior_selectrule" value="{{importprocess.id}}"></input></td>
                                    <td style="padding-left:50px;">
                                        <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{importprocess.processname}}" disabled="disabled" title="{{importprocess.processname}}">
                                    </td>
                                    <td>
                                        <input type="text" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{importprocess.processpath}}" disabled="disabled" title="{{importprocess.processpath}}">
                                    </td>
                                    <td>
                                        <div>
                                            <input id="process_behavior_solution_record_{{importprocess.id}}" {% if True == importprocess.solution_record %} checked="checked" {% endif %} type="checkbox"/>记录
                                            <input id="process_behavior_solution_stop_{{importprocess.id}}" {% if True == importprocess.solution_stop %} checked="checked" {% endif %} type="checkbox"/>阻止
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                                <tr id="type_process_behavior_2_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="process_behavior_button"  class="setbutton">
                                            <button onclick="adoprocess();ShowDiv('process_behavior_protect_add','fade','process_behavior');">添加</button>
                                            <button id="process_behavior_change" onclick="changeprocess();">修改</button>
                                            <button id="process_behavior_del" onclick="delselectprocess();">删除</button>
                                        </div>
                                    </td>
                                </tr>

                            </table>
                        </div>
                    </div>
                    <div id="process_behavior_protect_add" class="white_content" style="top: 290px;left:970px;width:550px;height:400px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="process_behavior_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">增加进程行为控制规则</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('process_behavior_protect_add','fade');"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div class="addrule" style="padding-left:0px;">
                            <div style="padding-top: 13px;font-size: 18px;background: #f6f2ea;padding-left: 50px;height: 50px;">
                                <span>程序路径：</span>
                                <input id="process_behavior_rule_path" maxlength="255" type="text" class="inputzk" style="width: 300px;padding: unset;height: 28px;" value="" />
                                <input id="process_behavior_id" style="display:none;" value="">
                            </div>
                            <div style="padding-left: 50px;height: -webkit-fill-available;">
                                <div class="addprocessdiv">
                                    <div class="addprocesstitle" style="padding-top:5px;">
                                        <span style="font-size: 18px;">网络行为控制</span>
                                    </div>
                                    <ul style="padding-left: 0px;">
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noexternalTCPlink" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_communicate"/> 拒绝外部TCP连接</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_notooutTCPlink" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_communicate"/> 拒绝对外发起TCP连接</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noacceptUDP" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_communicate"/> 拒绝接受UDP包</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nosendUDP" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_communicate"/> 禁止对外发UDP包</div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="addprocessdiv">
                                    <div class="addprocesstitle" style="padding-top:5px;">
                                        <span style="font-size: 18px;">文件行为控制</span>
                                    </div>
                                    <ul style="padding-left: 0px;">
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nonewexe" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_newexe"/> 禁止创建exe文件</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nonewdll" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_newdll"/> 禁止创建dll文件</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nochangeexe" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_changeexe"/> 禁止修改exe文件</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nochangedll" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_changedll"/> 禁止修改dll文件</div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="addprocessdiv">
                                    <div class="addprocesstitle" style="padding-top:5px;">
                                        <span style="font-size: 18px;">系统行为控制</span>
                                    </div>
                                    <ul style="padding-left: 0px;">
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nodrive" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_drive"/> 禁止加载驱动</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noinject" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_noinject"/> 禁止程序注入</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_norestart" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 禁止系统重启</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noglobalhool" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 禁止安装全局钩子</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nosendwmclose" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 禁止发送WM_CLOSE消息</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noaddtaskplan" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 禁止添加任务计划</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_noserviceprotect" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 系统服务保护</div>
                                        </li>
                                        <li class="li_block">
                                            <div><input type="checkbox" id="process_behavior_nosysaccountprotect" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_norestart"/> 系统账号保护</div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="addprocessdiv">
                                    <div class="addprocesstitle" style="padding-top:5px;">
                                        <span style="font-size: 18px;">子进程启动行为控制</span>
                                    </div>
                                    <ul style="padding-left: 0px;">
                                        <li class="li_block">
                                            <div>
                                                <input type="checkbox" id="process_behavior_nochildprocess" name="process_behavior_trail" style="margin-left: 20px;" value="check_no_nochildprocess"/> 创建子进程
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div style="margin-top: 520px;margin-bottom: 10px;text-align: right;">
                                <button onclick="preocess_behavior_chooseallornot('close')"  class="confirmbtn">全部关闭</button>
                                <button onclick="preocess_behavior_chooseallornot('open')" class="confirmbtn">全部开启</button>
                                <button id="process_behavior_addrulebtn" onclick="CloseDiv('process_behavior_protect_add','fade');saveprocess('');" class="confirmbtn">保存</button>
                            </div>
                        </div>
                    </div>
                    <div id="whitelist_access_control_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">登录保护-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="checkadddiv('login_protIp_protect_add');CloseDiv('whitelist_access_control_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <div>
                                <div class="tab" style="width: 97%;padding-top: 0px;">
                                     <!--<div class="tab_menu" style="width: 375px;">-->
                                         <!--<span style="color:#141212e8;float:left;font-size: 17px;padding: 7px 5px 0px 15px;height: 99%;background: #f3f7f9;">通过IP认证的方式来防止远程连接:</span>-->
                                         <!--<ul>-->
                                             <!--<li id="login_prot_IP" class="on" style="width:124px;"><a href="javascript:;">IP认证</a></li>-->
                                             <!--<li id="login_prot_name" style="width:124px;"><a href="javascript:;">计算机名认证</a></li>-->
                                         <!--</ul>-->
                                     <!--</div>-->
                                     <div id="login_prot_div" class="tab_box">
                                         <div>
                                             <table width="100%" style="line-height: 50px;">
                                                 <tr id="type_login_protIP_2_1" class="rulelisthead">
                                                    <td><input style="margin-left: 40px;" id="login_protIP_controlAll" name="controlAll" type="checkbox"/>全选</td>
                                                    <td>
                                                        IP
                                                    </td>
                                                    <td>
                                                        备注
                                                    </td>
                                                    <td>
                                                        状态
                                                    </td>
                                                </tr>
                                                {% for whitelist in whitelists %}
                                                 {% if 'COMPUTER_IP' == whitelist.authmethod %}
                                                    <tr id="type_login_protip_2_{{whitelist.id}}" class="rulelist">
                                                        <td style="padding-left:50px;"><input type="checkbox" name="login_protip_selectrule" value="{{whitelist.whitelist}}" /></td>
                                                        <td>
                                                            {{whitelist.whitelist}}
                                                        </td>
                                                        <td>
                                                            <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{whitelist.remark}}" disabled="disabled" title="{{whitelist.remark}}"/>
                                                        </td>
                                                        <td>
                                                            <form action="." method="get">
                                                                <span id="whitelist_{{whitelist.id}}" style="display:block" class="icon_close_a"></span>
                                                            </form>
                                                        </td>
                                                    </tr>
                                                 {% endif %}
                                                {% endfor %}
                                                 <tr id="type_login_protIP_2_btn" class="rulelistbtn">
                                                    <td colspan="4" style="padding-top:10px;">
                                                        <span id="whitelist_access_controlip_button"  class="setbutton">
                                                            <button onclick="ShowDiv('login_protIp_protect_add','fade','whitelist_access_control');">增加</button>
                                                            <button id="login_protip_changerule" onclick="changeipwhitelist();">修改</button>
                                                            <button id="login_protip_delrule" onclick="delwhitelistip();">删除</button>
                                                        </span>
                                                    </td>
                                                </tr>
                                             </table>
                                         </div>
                                         <div>
                                             <table width="100%" style="line-height: 50px;">
                                                 <tr id="type_login_prot_2_1" class="rulelisthead">
                                                    <td><input style="margin-left: 40px;" id="login_protName_controlAll" name="controlAll" type="checkbox"/>全选</td>
                                                    <td>
                                                        计算机名称
                                                    </td>
                                                    <td>
                                                        备注
                                                    </td>
                                                    <td>
                                                        状态
                                                    </td>
                                                </tr>
                                                {% for whitelist in whitelists %}
                                                 {% if 'COMPUTER_NAME' = whitelist.authmethod %}
                                                    <tr id="type_login_prot_2_{{whitelist.id}}" class="rulelist">
                                                        <td style="padding-left:50px;"><input type="checkbox" name="login_protname_selectrule" value="{{whitelist.whitelist}}"></input></td>
                                                        <td>
                                                            {{whitelist.whitelist}}
                                                        </td>
                                                        <td>
                                                            {{whitelist.remark}}
                                                        </td>
                                                        <td>
                                                            <form action="." method="get">
                                                                <span style="width: 57px;height: 18px;display: block;" id="whitelist_{{whitelist.id}}"></span>
                                                            </form>
                                                        </td>
                                                    </tr>
                                                 {% endif %}
                                                {% endfor %}
                                                 <tr id="type_login_2_btn" class="rulelistbtn">
                                                    <td colspan="4" style="padding-top:10px;">
                                                        <span id="whitelist_access_control_button"  class="setbutton">
                                                            <button onclick="ShowDiv('login_protName_protect_add','fade','whitelist_access_control');">增加</button>
                                                            <button id="login_protname_changerule" onclick="changenamewhitelist();">修改</button>
                                                            <button id="login_protname_delrule" onclick="delwhitelistname();">删除</button>
                                                        </span>
                                                    </td>
                                                </tr>
                                             </table>
                                         </div>
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="login_protIp_protect_add" class="white_content" style="top: 300px;left:1030px;width:400px;height:250px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="login_protIp_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">IP认证方式</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('login_protIp_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="padding-left: 50px;font-size: 20px;height: 120px;padding-top: 20px;">
                            <div style="padding-top: 15px;">
                                <span>白名单：</span>
                                <input id="login_protIp_whitelist" type="text" class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" placeholder="请输入IP地址" onblur='checkthisIP(this);'/>
                            </div>
                            <div style="padding-top: 15px;">
                                <span style="margin-left: 20px;">备注：</span>
                                <input id="login_protIp_remark" type="text" maxlength="30"  class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" />
                                <input id="login_protIp_id" type="text" class="inputzk" style="display:none;" value="" />
                            </div>
                        </div>
                        <div style="text-align: center;padding-top: 40px;">
                            <button id="login_protIp_apply" onclick="CloseDiv('login_protIp_protect_add','fade');SaveIpWhitelist();" style="width:100px;">应用</button>
                        </div>
                    </div>
                    <div id="login_protName_protect_add" class="white_content" style="top: 300px;left:1030px;width:400px;height:250px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="login_protName_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">计算机名认证方式</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('login_protName_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="padding-left: 50px;font-size: 20px;height: 120px;padding-top: 20px;">
                            <div style="padding-top: 15px;">
                                <span>白名单：</span>
                                <input id="login_protName_whitelist" type="text" class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" placeholder="请输入计算机名"/>
                            </div>
                            <div style="padding-top: 15px;">
                                <span style="margin-left: 20px;">备注：</span>
                                <input id="login_protName_remark" type="text" class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" />
                                <input id="login_protName_id" type="text" class="inputzk" style="display:none;" value="" />
                            </div>
                        </div>
                        <div style="text-align: center;padding-top: 40px;">
                            <button id="login_protName_apply" onclick="CloseDiv('login_protName_protect_add','fade');SaveNameWhitelist();" style="width:100px;">应用</button>
                        </div>
                    </div>

                    <div id="netfirewall" style="height:40px;margin:10px;background: rgba(202, 151, 83, 0.1803921568627451);padding-top:1px;">
                        <h4 style="padding-left:15px;color:#0000008f;">网络防火墙</h4>
                    </div>
                    <div style="height:275px;background:#f3f7f9;margin-left: 10px;margin-right: 10px;">
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">ARP防火墙：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="ARPfirwall"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="ARPfirwall_a" onclick="ShowDiv('ARPfirwall_protect_set','fade','ARPfirwall')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">DDoS防火墙：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="DDosfirwall"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="DDosfirwall_a" onclick="ShowDiv('DDosfirwall_protect_set','fade','DDosfirwall')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">Web防火墙：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="Web_firwall"></div>
                                </form></li>
                            <!--<li style="border: none;width: 200px;"><a id="Web_firwall_a" onclick="ShowDiv('Web_firwall_protect_set','fade','Web_firwall');Web_firwall_show('{{netfirewall.WebFirewal_VerifySessionLevel}}');" href="javascript:;">规则设置</a></li>-->
                            <li style="border: none;width: 200px;"><a id="Web_firwall_a" onclick="ShowDiv('Web_firwall_protect_set','fade','Web_firwall');" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">FTP防暴力破解：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="FTP_avoidviolence"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="FTP_avoidviolence_a" onclick="ShowDiv('FTP_avoidviolence_protect_set','fade','FTP_avoidviolence')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">远程桌面防暴力破解：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="ReDesktop_avoidviolence"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="ReDesktop_avoidviolence_a" onclick="ShowDiv('ReDesktop_avoidviolence_protect_set','fade','ReDesktop_avoidviolence')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">MySQL防暴力破解：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="MySQL_avoidviolence"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="MySQL_avoidviolence_a" onclick="ShowDiv('MySQL_avoidviolence_protect_set','fade','MySQL_avoidviolence')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">MSSQL防暴力破解：</li>
                            <li style="border: none;width: 200px;"><form action="." method="get">
                                    <div id="MSSQL_avoidviolence"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="MSSQL_avoidviolence_a" onclick="ShowDiv('MSSQL_avoidviolence_protect_set','fade','MSSQL_avoidviolence')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">拦截IP监控：</li>
                            <li style="border: none;width: 200px;height: 1px;"></li>
                            <li style="border: none;width: 200px;"><a id="Intercept_IP_a" onclick="ShowDiv('InterceptIP_protect_set','fade','MSSQL_avoidviolence')" href="javascript:;">规则设置</a></li>
                        </ul>
                    </div>
                    <div id="portprot" style="height:40px;margin:10px;background: rgba(202, 151, 83, 0.1803921568627451);padding-top:1px;">
                        <h4 style="padding-left:15px;color:#0000008f;">端口保护</h4>
                    </div>
                    <div style="height:90px;background:#f3f7f9;margin-left: 10px;margin-right: 10px;">
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">端口安全策略：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="port_security"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"><a id="port_security_a" onclick="ShowDiv('port_security_protect_set','fade','port_security')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">禁止ping本机：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="forbid_ping"></div>
                                </form></li>
                            <li style="border: none;width: 200px;"></li>
                        </ul>

                    </div>
                    <div style="height:40px;margin:10px;background: rgba(202, 151, 83, 0.1803921568627451);padding-top:1px;">
                        <h4 style="padding-left:15px;color:#0000008f;">超级黑白名单</h4>
                    </div>
                    <div style="height:90px;background:#f3f7f9;margin-left: 10px;margin-right: 10px;">
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">超级黑名单：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="super_blacklist"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="super_blacklist_a" onclick="loadsuperlistremark();ShowDiv('super_blacklist_protect_set','fade','super_blacklist')" href="javascript:;">规则设置</a></li>
                        </ul>
                        <ul class="ulzk" style="border: none;padding-top:20px;height:18px;text-align:left;">
                            <li style="border: none;width: 200px;">超级白名单：</li>
                            <li style="border: none;width: 200px;">
                                <form action="." method="get">
                                    <div id="super_whitelist"></div>
                                </form>
                            </li>
                            <li style="border: none;width: 200px;"><a id="super_whitelist_a" onclick="loadsuperlistremark();ShowDiv('super_whitelist_protect_set','fade','super_whitelist')" href="javascript:;">规则设置</a></li>
                        </ul>
                    </div>
                    <div id="super_blacklist_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">超级黑名单-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('super_blacklist_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_super_blacklist_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="3">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">超级黑名单</span>
                                        <span style="font-size: 10px;padding-top: 12px;">设置服务器拒绝访问的IP列表。</span>
                                    </td>
                                </tr>
                                <tr id="type_super_blacklist_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;"><div style=""><input id="super_blacklist_controlAll" name="super_blacklist_controlAll" type="checkbox"/> 全选</div></td>
                                    <td style="padding-left:50px;">
                                        地址
                                    </td>
                                    <td>
                                        备注
                                    </td>
                                </tr>
                                {% for superlist in superlists %}
                                    {% if 'SUPER_BLACKLIST' == superlist.listtype%}
                                    <tr id="type_super_blacklist_2_{{superlist.id}}" class="rulelist">
                                        <td style="padding-left:50px;"><input type="checkbox" name="super_blacklist_selectrule" value="{{superlist.id}}"></input></td>
                                        <td style="padding-left:50px;">
                                            {% if superlist.addr %}
                                                {{superlist.addr}}
                                            {% else %}
                                                {{superlist.startip}}-{{superlist.endip}}
                                            {% endif %}
                                        </td>
                                        <td>
											<input id="super_remark_{{superlist.id}}" type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" disabled="disabled" />
                                        </td>
                                    </tr>
                                    {% endif %}
                                {% endfor %}
                                <tr id="type_super_blacklist_2_btn" class="rulelistbtn">
                                    <td colspan="3">
                                        <div id="super_blacklist_button"  style="float: right;padding-right: 27px;padding-bottom: 10px;padding-top: 10px;">
                                            <button onclick="AddSuperblacklist();ShowDiv('super_blacklist_protect_add','fade','super_blacklist');">添加</button>
                                            <button id="super_blacklist_change" onclick="changesuperblacklist();">修改</button>
                                            <button id="super_blacklist_del" onclick="delselectsuperlist();">删除</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="super_blacklist_protect_add" class="white_content" style="top: 300px;left:1000px;width:450px;height:370px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="super_blacklist_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">超级黑名单</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('super_blacklist_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div class="tab" style="width: 90%;padding-top: 0px;margin: 0 auto;">
                            <input id="super_blacklist_id" type="text" class="inputzk" style="display:none;" value="" />
                            <div style="">
                                 <div class="tab_menu" style="width: 375px;">
                                     <span style="color:#141212e8;float:left;font-size: 17px;padding: 7px 5px 0px 15px;height: 99%;background: #f3f7f9;">选择添加类型:</span>
                                     <ul>
                                         <li id="superblacklist_oneip" class="on" style="width:124px;"><a href="javascript:;">单一IP地址</a></li>
                                         <li id="superblacklist_segmentip" style="width:124px;"><a href="javascript:;">IP地址段</a></li>
                                     </ul>
                                 </div>
                            </div>
                            <div id="superblacklist_div" class="tab_box_superblacklist" style="padding-left:20px;margin-top: 5px;">
                                <div>
                                    IP地址:<input id="super_blacklist_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <span style="display: block;">备注：</span><textarea wrap="hard" maxlength="30" id="super_blacklist_oneip_remark" style="height: 150px;display: block;width: 80%;margin-left: 50px;margin-top: -15px;"></textarea>
                                    <div style="text-align: center;padding-top: 15px;">
                                        <button onclick="CloseDiv('super_blacklist_protect_add','fade');SaveSuperblacklist('singleip');" style="width:100px;">应用</button>
                                    </div>
                                </div>
                                <div>
                                    起始IP地址:<input style="margin: 4px 8px;" id="super_blacklist_start_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <br>
                                    结尾IP地址:<input style="margin: 4px 8px;" id="super_blacklist_end_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <span style="display: block;">备注：</span><textarea type="text" maxlength="30" id="super_blacklist_ips_remark" style="height: 120px;display: block;width: 80%;margin-left: 50px;margin-top: -15px;"></textarea>
                                    <div style="text-align: center;padding-top: 15px;">
                                    <button onclick="CloseDiv('super_blacklist_protect_add','fade');SaveSuperblacklist('ipsegment');" style="width:100px;">应用</button>
							    </div>
                                </div>
                            </div>
						</div>
					</div>
                    <div id="super_whitelist_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">超级白名单-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('super_whitelist_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_super_whitelist_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="3">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">超级白名单</span>
                                        <span style="font-size: 10px;padding-top: 12px;">设置服务器允许访问的IP列表。</span>
                                    </td>
                                </tr>
                                <tr id="type_super_whitelist_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;"><div style=""><input id="super_whitelist_controlAll" name="super_whitelist_controlAll" type="checkbox"/> 全选</div></td>
                                    <td style="padding-left:50px;">
                                        地址
                                    </td>
                                    <td>
                                        备注
                                    </td>
                                </tr>
                                {% for superlist in superlists %}
                                    {% if 'SUPER_WHITELIST' == superlist.listtype%}
                                    <tr id="type_super_whitelist_2_{{superlist.id}}" class="rulelist">
                                        <td style="padding-left:50px;"><input type="checkbox" name="super_whitelist_selectrule" value="{{superlist.id}}"></input></td>
                                        <td style="padding-left:50px;">
                                            {% if superlist.addr %}
                                                {{superlist.addr}}
                                            {% else %}
                                                {{superlist.startip}}-{{superlist.endip}}
                                            {% endif %}
                                        </td>
                                        <td>
                                            <input id="super_remark_{{superlist.id}}" type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" disabled="disabled" />
                                        </td>
                                    </tr>
                                    {% endif %}
                                {% endfor %}
                                <tr id="type_super_whitelist_2_btn" class="rulelistbtn">
                                    <td colspan="3">
                                        <div id="super_whitelist_button"  style="float: right;padding-right: 27px;padding-bottom: 10px;padding-top: 10px;">
                                            <button onclick="AddSuperwhitelist();ShowDiv('super_whitelist_protect_add','fade','super_whitelist');">添加</button>
                                            <button id="super_whitelist_change" onclick="changesuperlist();">修改</button>
                                            <button id="super_whitelist_del" onclick="delselectsuperwhitelist();">删除</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="super_whitelist_protect_add" class="white_content" style="top: 300px;left: 1000px;width: 450px;height: 370px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">
                            <p id="super_whitelist_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">超级白名单</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('super_whitelist_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div class="tab" style="width: 90%;padding-top: 0px;margin: 0 auto;">
                            <input id="super_whitelist_id" type="text" class="inputzk" style="display:none;" value="" />
                            <div style="">
                                 <div class="tab_menu" style="width: 375px;">
                                     <span style="color:#141212e8;float:left;font-size: 17px;padding: 7px 5px 0px 15px;height: 99%;background: #f3f7f9;">选择添加类型:</span>
                                     <ul>
                                         <li id="superwhitelist_oneip" class="on" style="width:124px;"><a href="javascript:;">单一IP地址</a></li>
                                         <li id="superwhitelist_segmentip" style="width:124px;"><a href="javascript:;">IP地址段</a></li>
                                     </ul>
                                 </div>
                            </div>
                            <div id="superwhitelist_div" class="tab_box_superwhiteist" style="padding-left:20px;margin-top: 5px;">
                                <div>
                                    IP地址:<input id="super_whitelist_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <span style="display: block;">备注：</span><textarea id="super_whitelist_oneip_remark" maxlength="30" style="height: 150px;display: block;width: 80%;margin-left: 50px;margin-top: -15px;"></textarea>
                                    <div style="text-align: center;padding-top: 15px;">
                                        <button onclick="CloseDiv('super_whitelist_protect_add','fade');SaveSuperwhitelist('singleip');" style="width:100px;">应用</button>
                                    </div>
                                </div>
                                <div>
                                    起始IP地址:<input style="margin: 4px 8px;" id="super_whitelist_start_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <br>
                                    结尾IP地址:<input style="margin: 4px 8px;" id="super_whitelist_end_addr" placeholder="192.168.1.1" onblur='checkthisIP(this);'>
                                    <span style="display: block;">备注：</span><textarea maxlength="30" id="super_whitelist_ips_remark" style="height: 120px;display: block;width: 80%;margin-left: 50px;margin-top: -15px;"></textarea>
                                    <div style="text-align: center;padding-top: 15px;">
                                        <button onclick="CloseDiv('super_whitelist_protect_add','fade');SaveSuperwhitelist('ipsegment');" style="width:100px;">应用</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="ARPfirwall_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">ARP防火墙-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('ARPfirwall_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_ARPfirwall_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="3">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">ARP防火墙</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受ARP欺骗攻击</span>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_1_1" class="rulelisthead">
                                    <td colspan="3">
                                        <div style="padding-top:10px;">
                                            <p style="font-size: 18px;color:unset;padding-left: 32px;">网关及DNS设置</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_1_auto" class="rulelist">
                                    <td style="padding-left:50px;"><input type="radio" {% if 0 = netfirewall.mode %}  checked="checked" {% endif %} name="ARPfirwall_selectrule" value="auto" style="display:none;"></input>自动获取</td>
                                    <td>
                                        防火墙自动获取网关及DNS的IP/MAC地址，并自动保护
                                    </td>
                                    <td>
                                        <button style="line-height: 20px;width:75px;" onclick="ShowDiv('ARPfirwall_gateway_protect_set','fade','ARPfirwall');">查看</button>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_1_manual" class="rulelist" style="display:none;">
                                    <td style="padding-left:50px;"><input type="radio" {% if 1 = netfirewall.mode %}  checked="checked" {% endif %} name="ARPfirwall_selectrule" value="manu"></input>手动获取</td>
                                    <td>
                                        如果你需要在不同的网络间切换，建议手动设置保护网关及DNS
                                    </td>
                                    <td>
                                        <button style="line-height: 20px;width:75px;" onclick="ShowDiv('ARPfirwall_customize_gateway_protect_set','fade','ARPfirwall');">设置</button>
                                    </td>
                                </tr>
                            </table>
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_ARPfirwall_2_1" class="rulelisthead">
                                    <td colspan="3">
                                        <div style="padding-top:10px;">
                                            <p style="font-size: 18px;color:unset;padding-left: 32px;">拦截攻击类型设置</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_2_2" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox"  name="ARPfirwall_selectrule" value="InterceptExternalARPAttacks" checked="checked" disabled="disabled"/>拦截外部ARP攻击</td>
                                    <td>
                                        拦截外部网关/DNS攻击欺骗（本功能必选）
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_2_3" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox" name="ARPfirwall_selectrule" value="InterceptLocalARPAttacks" {% if True == netfirewall.InterceptLocalARPAttacks %} checked="checked" {% endif %} />拦截本机对外ARP攻击</td>
                                    <td>
                                        拦截本机ARP木马对网内其他主机攻击（建议选择）
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_2_4" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox" name="ARPfirwall_selectrule" value="InterceptIPConflict" {% if True == netfirewall.InterceptIPConflict %} checked="checked" {% endif %} />拦截IP冲突</td>
                                    <td>
                                        拦截局域网内对本机IP冲突攻击（建议选择）
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_2_5" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox"  name="ARPfirwall_selectrule" value="LANStealth" {% if True == netfirewall.LANStealth %} checked="checked" {% endif %} />局域网隐身</td>
                                    <td>
                                        对局域网内的其它计算机的ARP请求不应答
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                                <tr id="type_ARPfirwall_2_btn" class="rulelistbtn">
                                    <td colspan="3">
                                        <div id="ARPfirwall_button" class="setbutton">
                                            <button id="ARPfirwall_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="ARPfirwalll_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="ARPfirwall_gateway_protect_set" class="white_content" style="top: 280px;left:975px;width:550px;height:400px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">查看网关</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('ARPfirwall_gateway_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="gateway_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_gateway_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">防火墙自动保护的网卡信息如下：</span>
                                    </td>
                                </tr>
                                <tr id="type_gateway_1_1" class="rulelist">
                                    <td class="padding_left" width="33%" style="padding-left: 30px;">
                                        IP地址
                                    </td>
                                    <td width="30%" style="padding-left:5px;">MAC</td>
                                    <td width="12%">网络连接名称</td>
                                    <td width="25%">属性</td>
                                </tr>
                                {% for gateway in gateways %}
                                <tr class="rulelist">
                                    <td class="padding_left" style="padding-left:30px;">
                                        {{gateway.IP}}
                                    </td>
                                    <td style="padding-left:5px;">
                                    <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{gateway.MAC}}" disabled="disabled" title="{{gateway.MAC}}"/></td>
                                    <td><input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{gateway.connectname}}" disabled="disabled" title="{{gateway.connectname}}"/></td>
                                    <td>本地IP</td>
                                </tr>
                                <tr class="rulelist">
                                    <td class="padding_left" style="padding-left:30px;">
                                        {{gateway.gatewayip}}
                                    </td>
                                    <td style="padding-left:5px;">
                                    <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{gateway.gatewaymac}}" disabled="disabled" title="{{gateway.gatewaymac}}"/></td>
                                    <td>
                                        <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{gateway.connectname}}" disabled="disabled" title="{{gateway.connectname}}"/>
                                    </td>
                                    <td>网关</td>
                                </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                    <div id="ARPfirwall_customize_gateway_protect_set" class="white_content" style="top: 300px;left:1000px;width:480px;height:362px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">设置网关</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('ARPfirwall_customize_gateway_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="customize_gateway_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_customize_gateway_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">自定义网关IP和MAC绑定规则列表：</span>
                                    </td>
                                </tr>
                                <tr id="type_customize_gateway_1_1" class="rulelist">
                                    <td class="padding_left" style="width: 35%;">
                                        本地IP地址：
                                    </td>
                                    <td>
                                        <input id="localip" maxlength="30" style="width: 200px;padding: 6px 5px;" {% if netfirewall.IP %} value="{{netfirewall.IP}}" {% endif %} placeholder="192.168.0.1" onblur="this.value=this.value.replace(/[^0-9.]/,'');">
                                    </td>
                                </tr>
                                <tr id="type_customize_gateway_1_2" class="rulelist">
                                    <td class="padding_left">
                                        本地MAC地址：
                                    </td>
                                    <td>
                                        <input id="localmac" maxlength="17" style="width: 200px;padding: 6px 5px;" {% if netfirewall.MAC %} value="{{netfirewall.MAC}}" {% endif %} placeholder="00-15-44-14-14-14" onblur="checkthisMac(this);">
                                    </td>
                                </tr>
                                <tr id="type_customize_gateway_1_3" class="rulelist">
                                    <td class="padding_left">
                                        网关IP地址：
                                    </td>
                                    <td>
                                        <input id="gatewayip" maxlength="17" style="width: 200px;padding: 6px 5px;" {% if netfirewall.GatewayIP %} value="{{netfirewall.GatewayIP}}" {% endif %} placeholder="192.168.0.1" onblur="this.value=this.value.replace(/[^0-9.]/,'');">
                                    </td>
                                </tr>
                                <tr id="type_customize_gateway_1_4" class="rulelist">
                                    <td class="padding_left">
                                        网关MAC地址：
                                    </td>
                                    <td>
                                        <input id="gatewaymac" maxlength="30" style="width: 200px;padding: 6px 5px;" {% if netfirewall.GatewayMAC %} value="{{netfirewall.GatewayMAC}}" {% endif %} placeholder="00-15-44-14-14-14" onblur="checkthisMac(this);">
                                    </td>
                                </tr>

                                <tr id="type_customize_gateway_1_btn" class="rulelistbtn">
                                    <td colspan="2">
                                        <div id="customize_gateway_button"  style="float: right;padding-right: 27px;padding-bottom: 10px;padding-top: 10px;">
                                            <!--<button onclick="ShowDiv('ARPfirwall_customize_gateway_protect_add','fade','ARPfirwall');">添加</button>-->
                                            <button id="customize_gateway_change" onclick="CloseDiv('ARPfirwall_customize_gateway_protect_set','fade');" style="width: 75px;">确定</button>
                                            <!--<button id="customize_gateway_del" onclick="delselectcustomizegateway();">删除</button>-->
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="ARPfirwall_customize_gateway_protect_add" class="white_content" style="top: 370px;left:1055px;width:370px;height:250px;text-align:left;">
                        <div style="cursor:default;height:40px;background: #436fac;">
                            <p id="customize_gateway_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">增加IP/MAC对</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('ARPfirwall_customize_gateway_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="padding-left: 50px;font-size: 20px;height: 120px;padding-top: 20px;">
                            <div style="padding-top: 15px;">
                                <span>IP地址：</span>
                                <input id="customize_gateway_addr" type="text" class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" placeholder="请输入IP地址"/>
                            </div>
                            <div style="padding-top: 15px;">
                                <span style="margin-left: -30px;">MAC地址：</span>
                                <input id="customize_gateway_remark" type="text" class="inputzk" style="width: 200px;padding: unset;height: 30px;" value="" placeholder="请输入MAC地址"/>
                                <input id="customize_gateway_id" type="text" class="inputzk" style="display:none;" value="" />
                                <span style="font-size: 15px;margin-top: 10px;display: block;padding-left: 90px;">格式：00-16-D3-1C-2A-91</span>
                            </div>
                        </div>
                        <div style="text-align: center;padding-top: 40px;">
                            <button id="customize_gateway_apply" onclick="CloseDiv('ARPfirwall_customize_gateway_protect_add','fade');" style="width:80px;">确定</button>
                        </div>
                    </div>
                    <div id="DDosfirwall_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">DDoS防火墙-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('DDosfirwall_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="DDosfirwall_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_DDosfirwall_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">DDoS防火墙</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受流量攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_DDosfirwall_1_1" class="rulelist">
                                    <td class="padding_left" width="30%">
                                        SYN攻击
                                    </td>
                                    <td>每 <input type="number" min="1" id="synattack_sec" value="{{netfirewall.SYNAttack_Seconds}}"  onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒响应TCP连接请求数：<input type="number" min="1" id="synattack_time" value="{{netfirewall.SYNAttack_times}}" onblur="var v=this.value||'';if((v!='') && (v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/></td>
                                </tr>
                                <tr id="type_DDosfirwall_1_2" class="rulelist">
                                    <td class="padding_left">
                                        扫描攻击
                                    </td>
                                    <td>每 <input type="number" min="1" id="scanattack_sec" value="{{netfirewall.ScanAttack_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒响应请求连接的端口数：<input type="number" min="1" id="scanattack_time"  value="{{netfirewall.ScanAttack_times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/></td>

                                </tr>
                                <tr id="type_DDosfirwall_1_3" class="rulelist">
                                    <td class="padding_left">
                                        流量攻击
                                    </td>
                                    <td>每 <input type="number" min="1" id="flowattack_sec" value="{{netfirewall.FlowAttack_ICMP_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内服务器最多接收ICMP包次数：<input type="number" min="1" id="flowattack_time" value="{{netfirewall.FlowAttack_ICMP_times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/></td>
                                </tr>
                                <tr id="type_DDosfirwall_1_4" class="rulelist">
                                    <td class="padding_left">
                                    </td>
                                    <td>每 <input type="number" min="1" id="UDPbag_sec" value="{{netfirewall.FlowAttack_UDP_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内服务器最多接收UDP包次数：<input type="number" min="1"  id="UDPbag_time" value="{{netfirewall.FlowAttack_UDP_times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/></td>
                                </tr>
                            </table>
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_DDosfirwall_2_1" class="rulelist">
                                    <td class="padding_left" width="30%">
                                        IP冻结时间
                                    </td>
                                    <td>冻结攻击IP访问时间长度 <input type="number" min="1" id="DDoS_IPFreezeTime" value="{{netfirewall.DDoS_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分</td>
                                </tr>
                                <tr id="type_DDosfirwall_2_btn" class="rulelistbtn">
                                    <td colspan="2">
                                        <div id="DDosfirwall_button" class="setbutton">
                                            <button id="DDosfirwall_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="DDosfirwall_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="app_control_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">应用程序控制-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('app_control_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_app_control_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">应用程序控制</span>
                                        <span style="font-size: 10px;padding-top: 12px;">控制计算机程序的运行和安装。</span>
                                    </td>
                                </tr>
                                <tr id="type_app_control_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;" width="60%">
                                        程序类型
                                    </td>
                                    <td>
                                        防护策略
                                    </td>
                                </tr>
                                {% for apptype in apptypearray %}
                                    <tr id="type_app_control_{{apptype}}" onclick="return openOrCloseAlarmType(this.id);" class="rulelisthead">
                                        <td>
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 10px;margin-left: 50px;"></i>
                                            {{apptype}}
                                        </td>
                                        <td>
                                        </td>
                                    </tr>
                                    {% for app in apps %}
                                        {% if app.apptype == apptype %}
                                            <tr id="type_app_control_{{apptype}}_{{app.id}}" class="rulelist">
                                                <td style="padding-left:90px;">
                                                    {{app.appname}}
                                                </td>
                                                <td>
                                                    <div>
                                                        <input id="app_control_solution_stop_{{app.id}}" {% if True == app.solution_stop %} checked="checked" {% endif %} type="checkbox"/>阻止
                                                        <input id="app_control_solution_record_{{app.id}}" {% if True == app.solution_record %} checked="checked" {% endif %} type="checkbox"/>记录
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    {% endfor %}
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                    <div id="outside_control_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">外围控制-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('outside_control_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_outside_control_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">应用程序控制</span>
                                        <span style="font-size: 10px;padding-top: 12px;">控制计算机外部接入。</span>
                                    </td>
                                </tr>
                                <tr id="type_outside_control_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;" width="60%">
                                        设备类型
                                    </td>
                                    <td>
                                        防护策略
                                    </td>
                                </tr>
                                {% for devicetype in devicetypearray %}
                                    <tr id="type_outside_control_{{devicetype}}" onclick="return openOrCloseAlarmType(this.id);" class="rulelisthead">
                                        <td>
                                            <i class="btn_jianhao_a" style="width:22px;height:16px; float:left;margin-top: 10px;margin-left: 50px;"></i>
                                            {{devicetype}}
                                        </td>
                                        <td>
                                        </td>
                                    </tr>
                                    {% for device in devices %}
                                        {% if device.devicetype == devicetype %}
                                            <tr id="type_outside_control_{{devicetype}}_{{device.id}}" class="rulelist">
                                                <td style="padding-left:90px;">
                                                    {{device.devicename}}
                                                </td>
                                                <td>
                                                    <div>
                                                        <input id="outside_control_solution_stop_{{device.id}}" {% if True == device.solution_stop %} checked="checked" {% endif %} type="checkbox"/>阻止
                                                        <input id="outside_control_solution_record_{{device.id}}" {% if True == device.solution_record %} checked="checked" {% endif %} type="checkbox"/>记录
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    {% endfor %}
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                    <div id="remotelogin_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">异地登录-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('remotelogin_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_remotelogin_protect_1"  class="ruletypehead">
                                    <td style="cursor:pointer;width: 200px;">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">设置常用登录地点</span>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr id="type_remotelogin_protect_2_1" class="rulelist">
                                    <td style="padding-left:42px;width:200px;">
                                         常用登录地点一、
                                    </td>
                                    <td style="line-height:50px;">
                                        <div class="docs-methods">
                                            <form class="form-inline" style="overflow:unset;">
                                                <div id="distpicker">
                                                    <div class="form-group">
                                                        <div style="position: absolute;top:118px">
                                                            <input id="city-picker3" class="form-control" readonly type="text" value="{{server.commonlogincitya}}" data-toggle="city-picker" style="margin:unset;padding:unset;width: 350px;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="type_remotelogin_protect_3_1" class="rulelist">
                                    <td style="padding-left:42px;width:200px;">
                                         常用登录地点二、
                                    </td>
                                    <td style="line-height:50px;">
                                        <div class="docs-methods">
                                            <form class="form-inline" style="overflow:unset;">
                                                <div id="distpicker2">
                                                    <div class="form-group">
                                                        <div style="position: absolute;top:169px">
                                                            <input id="city-picker32" class="form-control" readonly type="text" value="{{server.commonlogincityb}}" data-toggle="city-picker" style="margin:unset;padding:unset;width: 350px;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="type_remotelogin_protect_4"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="2">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">设置异地登录提示</span>
                                    </td>
                                </tr>
                                <tr id="type_remotelogin_protect_4_1" class="rulelist">
                                    <td style="padding-left:42px;" colspan="2">
                                        {% if '' != profilephone %}
                                            <input type="checkbox" value="remotelogin_message" name="remotelogin"/> 手机短信
                                        {% else %}
                                            <input type="checkbox" value="remotelogin_message" disabled="disabled" name="remotelogin"/> 手机短信        还没有设置告警手机，<a href="{% url 'setting' %}">立即设置</a>
                                        {% endif %}
                                        <input type="checkbox" value="remotelogin_email" style="margin-left: 100px;" name="remotelogin"/> 发送邮件
                                    </td>
                                </tr>
                                <tr id="type_remotelogin_protect_5_1" class="rulelistbtn">
                                    <td colspan="2">
                                        <div id="RemoteLogin_button" class="setbutton">
                                            <button id="RemoteLogin_save">保存</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="Web_firwall_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">Web防火墙-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('Web_firwall_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="Web_firwall_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_Web_firwall_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">Web防火墙</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受CC攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_Web_firwall_1_1" class="rulelist">
                                    <td class="padding_left" width="30%">
                                        访问规则
                                    </td>
                                    <td colspan="2"><input type="number" id="WebFirewall_Seconds" style="margin-left: 0;" value="{{netfirewall.WebFirewall_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内单IP允许登录 <input type="number" id="WebFirewall_Times" value="{{netfirewall.WebFirewall_Times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/> 次</td>
                                    <td>
                                        <button style="line-height: 20px;width:110px;" onclick="ShowDiv('Webfirwall_URLwhitelist_protect_set','fade','Web_firwall')" href="javascript:;">设置URL白名单</button>
                                    </td>
                                </tr>
                                <tr id="type_Web_firwall_1_2" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td colspan="3">IP冻结时间 <input type="number" id="WebFirewall_IPFreezeTime" value="{{netfirewall.WebFirewall_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分钟</td>
                                    <!--<td colspan="2">IP放行时间 <input type="number" id="WebFirewall_IPAllowTime" value="{{netfirewall.WebFirewall_IPAllowTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分钟</td>-->
                                </tr>
                                <tr id="type_Web_firwall_1_3" class="rulelist">
                                    <td class="padding_left">
                                        端口设置
                                    </td>
                                    <td colspan="3">保护的端口 <input type="text" id="WebFirewal_ProtPort" style="width: 260px;" value="{{netfirewall.WebFirewal_ProtPort}}" title="{{netfirewall.WebFirewal_ProtPort}}" onblur="this.value=this.value.replace(/[^0-9;]/g,'');"/>多个端口以;(英文状态下)分割</td>
                                </tr>
                                <tr id="type_Web_firwall_1_4" class="rulelist">
                                    <!--<td class="padding_left">会话验证</td>-->
                                    <!--<td colspan="3"><input type="checkbox" id="WebFirewal_VerifySessionOn" style="height: 15px;width: 15px;margin-top: 13px;display: block;float: left;margin-right: 5px;" {%if netfirewall.WebFirewal_VerifySessionOn%} checked="checked" {% endif %}/>  启用会话验证模式</td>-->
                                </tr>
                                <!--<tr id="type_Web_firwall_1_5" class="rulelist">-->
                                    <!--<td class="padding_left">会话验证</td>-->
                                    <!--<td colspan="3">-->
                                        <!--<div onmouseout="hideMoreDiv('session_verify','session_verify_mode');" onmouseover="showMoreDiv('session_verify','session_verify_mode');" style="width: 100px;float: left;">-->
                                            <!--<div id="session_verify">-->
                                                <!--<input id="session_verify_juniora" class="modesetinput" value="初级模式" type="submit" style="color: #141212ad;width:90px;background:white;height:35px;border: 1px solid #e6e6e6;padding:unset;margin: 6px 0px 6px 0px;" />-->
                                            <!--</div>-->
                                            <!--<div class="session_verify_mode" id="session_verify_mode">-->
                                                <!--<input id="session_verify_junior" class="modesetinput" value="初级模式" type="submit" style="color: #141212ad;width:90px;background:white;height:35px;border: 1px solid #e6e6e6;padding:unset;" />-->
                                                <!--<input id="session_verify_middle"  class="modesetinput" value="中级模式" type="submit" style="color: #141212ad;width:90px;background:white;height:35px;border: 1px solid #e6e6e6;padding:unset;border-top: unset;" />-->
                                                <!--<input id="session_verify_high"  class="modesetinput" value="高级模式" type="submit" style="color: #141212ad;width:90px;background:white;height:35px;border: 1px solid #e6e6e6;padding:unset;border-top: unset;" />-->
                                            <!--</div>-->
                                        <!--</div>-->
                                        <!--<span id="session_verify_info" style="margin-top: 5px;display: block;color: #141212ad;">该模式对攻击判断较为宽松(正常情况下推荐)</span>-->
                                    <!--</td>-->
                                <!--</tr>-->
                                <tr id="type_Web_firwall_1_6" class="rulelist">
                                    <td class="padding_left">代理规则
                                    </td>
                                    <td>最大IP数： <input type="number" min="0" id="WebFirewal_AgentMaxIPs" value="{{netfirewall.WebFirewal_AgentMaxIPs}}" onblur="var v=this.value||'';if((v!='') &&(v>=100)){alert('设置值不合法');this.value = 1;}"/>(0代表禁止访问)</td>
                                    <td>
                                    </td>
                                    <td>时间周期： <input type="number" id="WebFirewal_AgentTime" value="{{netfirewall.WebFirewal_AgentTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/>秒(30-1000秒)</td>
                                </tr>
                                <tr id="type_Web_firwall_1_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="Web_firwall_button" class="setbutton">
                                            <button id="Web_firwall_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="Web_firwall_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="Webfirwall_URLwhitelist_protect_set" class="white_content" style="top: 300px;left:1000px;width:480px;height:330px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">设置URL白名单</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('Webfirwall_URLwhitelist_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="Webfirwall_URLwhitelist_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_Webfirwall_URLwhitelist_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;line-height: 40px;" colspan="2">
                                        <span style="font-size: 15px;padding-top: 12px;margin-left: 32px;">对下列白名单内的URL进行访问，将不会被拦截：</span>
                                    </td>
                                </tr>
                                <tr id="type_Webfirwall_URLwhitelist_1_1" class="rulelist">
                                    <td class="padding_left" style="width:200px;padding-left:30px;">
                                        <input id="URLwhitelist_controlAll" name="URLwhitelistcontrolAll" type="checkbox"/> 全选
                                    </td>
                                    <td>
                                        URL
                                    </td>
                                </tr>
                                {% for urlwhitelist in urlwhitelists %}
                                <tr id="type_Webfirwall_URLwhitelist_1_2" class="rulelist">
                                    <td class="padding_left" style="padding-left:30px;">
                                        <input type="checkbox" name="URLwhitelist_selectrule" value="{{urlwhitelist.id}}"></input>
                                    </td>
                                    <td >
                                        <input type="text" class="inputzk" style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;" value="{{urlwhitelist.url}}" disabled="disabled" title="{{urlwhitelist.url}}"/>
                                    </td>
                                    <!--<td>-->
                                        <!--{{urlwhitelist.remark}}-->
                                    <!--</td>-->
                                </tr>
                                {% endfor %}
                                <tr id="URLwhitelist_protect_add" class="rulelistaddtr">
                                    <td class="padding_left" style="color:unset;width: 250px;padding-left:30px;">
                                        URL：<input type="text" id="URLwhitelist_url" maxlength="260" value="" style="width: 150px;"></input>
                                    </td>
                                    <!--<td>-->
                                        <!--备注：<input type="text" id="URLwhitelist_remark" value=""/>-->
                                    <!--</td>-->
                                    <td style="line-height: 20px;">
                                        <button onclick="saveurlwhitelist();" style="height:26px;">保存</button>
                                        <button onclick="CancelAddurlWhiteList();" style="height:26px;">取消</button>
                                    </td>
                                </tr>
                                <tr id="type_Webfirwall_URLwhitelist_1_btn" class="rulelistbtn">
                                    <td colspan="2">
                                        <div id="Webfirwall_URLwhitelist_button"  style="float: right;padding-right: 27px;padding-bottom: 10px;padding-top: 10px;">
                                            <button onclick="AddUrlWhiteList()">添加</button>
                                            <button id="Webfirwall_URLwhitelist_del" onclick="delselecturlwhitelist();">删除</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="FTP_avoidviolence_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">FTP防暴力破解-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('FTP_avoidviolence_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="FTP_avoidviolence_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_FTP_avoidviolence_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="3">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">FTP防暴力破解</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受FTP暴力破解攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_FTP_avoidviolence_1_1" class="rulelist">
                                    <td class="padding_left" width="30%" style="width: 200px;">
                                        FTP防暴力破解
                                    </td>
                                    <td colspan="2"><input type="number" id="FTP_avoidviolence_sec" value="{{netfirewall.FTP_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内单IP允许登录 <input type="number" id="FTP_avoidviolence_time"  value="{{netfirewall.FTP_Times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/> 次</td>
                                </tr>
                                <tr id="type_FTP_avoidviolence_1_2" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td colspan="2">IP冻结时间 <input type="number" id="FTP_avoidviolence_IPFreezeTime" value="{{netfirewall.FTP_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分钟</td>
                                </tr>
                                <tr id="type_FTP_avoidviolence_1_3" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td colspan="2">保护的端口 <input type="text" id="FTP_avoidviolence_protpoct" value="{{netfirewall.FTP_ProtPort}}" style="width: 250px;" title="{{netfirewall.FTP_ProtPort}}" onblur="this.value=this.value.replace(/[^0-9;]/g,'');"/> 多个端口以;(英文状态下)分割</td>

                                </tr>
                                <tr id="type_FTP_avoidviolence_1_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="FTP_avoidviolence_button" class="setbutton">
                                            <button id="FTP_avoidviolence_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="FTP_avoidviolence_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="ReDesktop_avoidviolence_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">远程桌面防暴力破解-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('ReDesktop_avoidviolence_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="ReDesktop_avoidviolence_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_ReDesktop_avoidviolence_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">远程桌面防暴力破解</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受远程桌面防暴力破解攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_ReDesktop_avoidviolence_1_1" class="rulelist">
                                    <td class="padding_left" width="30%" style="width: 200px;">
                                        远程桌面防暴力破解
                                    </td>
                                    <td colspan="2"><input type="number" id="ReDesktop_avoidviolence_sec" value="{{netfirewall.RemoteDesktop_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内单IP允许登录 <input type="number" id="ReDesktop_avoidviolence_time" value="{{netfirewall.RemoteDesktop_Times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/> 次</td>
                                </tr>
                                <tr id="type_ReDesktop_avoidviolence_1_2" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td>IP冻结时间 <input type="number" id="ReDesktop_IPFreezeTime" value="{{netfirewall.RemoteDesktop_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分钟</td>
                                    <td colspan="2"></td>
                                </tr>
                                <tr id="type_ReDesktop_avoidviolence_1_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="ReDesktop_avoidviolence_button" class="setbutton">
                                            <button id="ReDesktop_avoidviolence_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="ReDesktop_avoidviolence_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="MySQL_avoidviolence_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">MySQL防暴力破解-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('MySQL_avoidviolence_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="MySQL_avoidviolence_protect_set_div" style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_MySQL_avoidviolence_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">MySQL防暴力破解</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受MySQL防暴力破解攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_MySQL_avoidviolence_1_1" class="rulelist">
                                    <td class="padding_left" width="30%" style="width: 200px;">
                                        MySQL防暴力破解
                                    </td>
                                    <td colspan="2"><input type="number" id="MySqlDB_Seconds" value="{{netfirewall.MySqlDB_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内单IP允许登录 <input type="number" id="MySqlDB_Times" value="{{netfirewall.MySqlDB_Times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/> 次</td>
                                </tr>
                                <tr id="type_MySQL_avoidviolence_1_2" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td>IP冻结时间 <input type="number" id="MySqlDB_IPFreezeTime" value="{{netfirewall.MySqlDB_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"/> 分钟</td>
                                    <td colspan="2"></td>
                                </tr>
                                <tr id="type_MySQL_avoidviolence_1_3" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td colspan="3">保护的端口 <input type="text" id="MySqlDB_ProtPort" style="width: 260px;" value="{{netfirewall.MySqlDB_ProtPort}}" title="{{netfirewall.WebFirewal_ProtPort}}" onblur="this.value=this.value.replace(/[^0-9;]/g,'');"/> 多个端口以;(英文状态下)分割</td>
                                </tr>
                                <tr id="type_MySQL_avoidviolence_1_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="MySQL_avoidviolence_button" class="setbutton">
                                            <button id="MySQL_avoidviolence_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="MySQL_avoidviolence_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="MSSQL_avoidviolence_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">MSSQL防暴力破解-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('MSSQL_avoidviolence_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div id="MSSQL_avoidviolence_protect_set_div" style="cursor:default;
">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_MSSQL_avoidviolence_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="4">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">MSSQL防暴力破解</span>
                                        <span style="font-size: 10px;padding-top: 12px;">保护服务器免受MSSQL防暴力破解攻击。</span>
                                    </td>
                                </tr>
                                <tr id="type_MSSQL_avoidviolence_1_1" class="rulelist">
                                    <td class="padding_left" width="30%" style="width: 200px;">
                                        MSSQL防暴力破解
                                    </td>
                                    <td colspan="2"><input type="number" id="MSSqlDB_Seconds" value="{{netfirewall.MSSqlDB_Seconds}}" onblur="var v=this.value||'';if((v!='') &&(v>=1000||v<1)){alert('设置值不合法');this.value = 1;}"/> 秒内单IP允许登录 <input type="number" id="MSSqlDB_Times" value="{{netfirewall.MSSqlDB_Times}}" onblur="var v=this.value||'';if((v!='') &&(v>=10000||v<1)){alert('设置值不合法');this.value = 1;}"/> 次</td>
                                </tr>
                                <tr id="type_MSSQL_avoidviolence_1_2" class="rulelist">
                                    <td class="padding_left"></td>
                                    <td>IP冻结时间 <input type="number" id="MSSqlDB_IPFreezeTime" value="{{netfirewall.MSSqlDB_IPFreezeTime}}" onblur="var v=this.value||'';if((v!='') &&(v>=100||v<1)){alert('设置值不合法');this.value = 1;}"//> 分钟</td>
                                    <td colspan="2"></td>
                                </tr>
                                <tr id="type_MSSQL_avoidviolence_1_btn" class="rulelistbtn">
                                    <td colspan="4">
                                        <div id="MSSQL_avoidviolence_button" class="setbutton">
                                            <button id="MSSQL_avoidviolence_reset" style="width:108px;">恢复默认设置</button>
                                            <button id="MSSQL_avoidviolence_savechange">保存修改</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="InterceptIP_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">拦截IP监控-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('InterceptIP_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <div>
                                <div class="tab" style="width: 97%;padding-top: 0px;">
                                     <div class="tab_menu" style="margin: 0 auto;">
                                         <ul>
                                             <li id="interceptIP_blocked_IP" class="on" style="width:50%;"><a href="javascript:;">冻结IP</a></li>
                                             <li id="interceptIP_allowed_IP" style="width:50%;"><a href="javascript:;">放行IP</a></li>
                                         </ul>
                                     </div>
                                     <div id="interceptIP_div" class="tab_box">
                                         <div>
                                             <table width="100%" style="line-height: 50px;">
                                                 <tr id="type_InterceptIP_protect_2_1" class="rulelisthead">
                                                    <td><input style="margin-left: 40px;" id="blocked_IP_controlAll" name="controlAll" type="checkbox"/>全选</td>
                                                    <td>
                                                        IP地址
                                                    </td>
                                                    <td>
                                                        端口
                                                    </td>
                                                    <td>
                                                        地理位置
                                                    </td>
                                                     <td>
                                                        剩余时间
                                                    </td>
                                                     <td>
                                                        拦截类型
                                                    </td>
                                                </tr>
                                                {% for interceptip in interceptips %}
                                                 {% if 'BLOCK_IP' == interceptip.type %}
                                                    <tr id="type_blocked_IP_{{interceptip.id}}" class="rulelist">
                                                        <td style="padding-left:50px;"><input type="checkbox" name="selectblockip" value="{{interceptip.id}}" /></td>
                                                        <td>
                                                            {{interceptip.ip}}
                                                        </td>
                                                        <td>
                                                            {{interceptip.port}}
                                                        </td>
                                                        <td>
                                                            {{interceptip.postion}}
                                                        </td>
                                                         <td>
                                                             <span id="num_{{interceptip.id}}"></span>
                                                        </td>
                                                         <td>
                                                            {{interceptip.intercepttype}}
                                                        </td>
                                                    </tr>
                                                 {% endif %}
                                                {% endfor %}
                                             </table>
                                         </div>
                                         <div>
                                             <table width="100%" style="line-height: 50px;">
                                                 <tr id="type_allowed_IP_2_1" class="rulelisthead">
                                                    <td><input style="margin-left: 40px;" id="allowed_IP_controlAll" name="controlAll" type="checkbox"/>全选</td>
                                                    <td>
                                                        IP地址
                                                    </td>
                                                    <td>
                                                        端口
                                                    </td>
                                                    <td>
                                                        地理位置
                                                    </td>
                                                     <td>
                                                        剩余时间
                                                    </td>
                                                     <td>
                                                        拦截类型
                                                    </td>
                                                </tr>
                                                {% for interceptip in interceptips %}
                                                 {% if 'ALLOWED_IP' == interceptip.type %}
                                                    <tr id="type_blocked_IP_{{interceptip.id}}" class="rulelist">
                                                        <td style="padding-left:50px;"><input type="checkbox" name="selectallowip" value="{{interceptip.id}}" /></td>
                                                        <td>
                                                            {{interceptip.ip}}
                                                        </td>
                                                        <td>
                                                            {{interceptip.port}}
                                                        </td>
                                                        <td>
                                                            {{interceptip.postion}}
                                                        </td>
                                                         <td>
                                                             <span id="num_{{interceptip.id}}"></span>
                                                        </td>
                                                         <td>
                                                            {{interceptip.intercepttype}}
                                                        </td>
                                                    </tr>
                                                 {% endif %}
                                                {% endfor %}
                                             </table>
                                         </div>
                                     </div>
                                    <div>
                                        <span id="intercept_button"  class="setbutton">
                                            <button id="interceptIP_allow" onclick="changeInterceptType('ALLOWED_IP')" style="line-height: 20px;">放行</button>
                                            <button id="interceptIP_block" onclick="changeInterceptType('BLOCK_IP');" style="line-height: 20px;">冻结</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="port_security_protect_set" class="white_content" style="top: 190px;left:850px;width:770px;height:560px;text-align:left;">
                        <div style="cursor:default;height:56px;background: #436fac;width: 770px;">
                            <p style="font-size: 25px;color:white;width: 50%;float: left;margin-top: 2px;padding-left: 10px;">端口安全策略-规则设置</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('port_security_protect_set','fade')"><img style="padding-right:20px;padding-top:12px;" src="{% static 'images/close.png' %}" alt="退出"/></a>
                        </div>
                        <div style="cursor:default;">
                            <table width="100%" style="line-height: 50px;">
                                <tr id="type_port_security_1"  class="ruletypehead">
                                    <td class="border_dotted_bottom" style="cursor:pointer;width: 501px;" colspan="5">
                                        <span style="font-size: 20px;padding-top: 12px;margin-left: 32px;">端口安全策略</span>
                                        <span style="font-size: 10px;padding-top: 12px;">实时防止非法访问端口。</span>
                                    </td>
                                </tr>
                                <tr id="type_port_security_2_1" class="rulelisthead">
                                    <td style="padding-left:50px;" width="20%"><input id="port_security_controlAll" name="port_security_controlAll" type="checkbox"/> 全选</td>
                                    <td width="10%">
                                        端口
                                    </td>
                                    <td width="10%">
                                        协议
                                    </td>
                                    <td width="20%">
                                        策略
                                    </td>
                                    <td width="40%">
                                        例外
                                    </td>
                                </tr>
                                {% for port in ports %}
                                <tr id="type_port_security_2_{{port.id}}" class="rulelist">
                                    <td style="padding-left:50px;"><input type="checkbox" name="port_security_selectrule" value="{{port.id}}"></input></td>
                                    <td>
                                        {{port.port}}
                                    </td>
                                    <td>
                                        {{port.protocol}}
                                    </td>
                                    <td>
                                        {% if 'true' == port.rule %}
                                            所有IP一律接受
                                        {% else %}
                                            所有IP一律拒绝
                                        {% endif %}
                                    </td>
                                    <td>
                                        <input style="border: none;background: none;overflow: hidden;text-overflow: ellipsis;width:90%" value="{{port.exceptionvalue}}" disabled="disabled" title="{{port.exceptionvalue}}">
                                    </td>
                                </tr>
                                {% endfor %}
                                <tr id="type_port_security_2_btn" class="rulelistbtn">
                                    <td colspan="5">
                                        <div id="port_security_button"  class="setbutton">
                                            <button onclick="clean_port_add_div();addipsegment();ShowDiv('port_security_protect_add','fade','port_security');">添加</button>
                                            <button id="port_security_change" onclick="changeportsecurity();">修改</button>
                                            <button id="port_security_del" onclick="delselectport();">删除</button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div id="port_security_protect_add" class="white_content" style="top: 260px;left:950px;width:530px;height:450px;text-align:left;">
                        <div style="cursor:default;height:45px;background: #436fac;">  
                            <p id="port_security_titleid" style="font-size: 23px;color:white;width: 50%;float: left;padding-left: 10px;margin: unset;">增加端口安全策略</p>
                            <a style="float:right;" href="javascript:;" onclick="CloseDiv('port_security_protect_add','fade')"><img style="padding-right:10px;padding-top:7px;" src="{% static 'images/close.png' %}" alt="退出"/></a>  
                        </div>
                        <div id="port_security_add_div"  class="addrule" style="height: 270px;"> 
                            <div style="padding-top: 15px;">
                                <span>端口：</span>
                                <input id="port_security_port" type="number" class="inputzk" style="width: 200px;padding: unset;" value="" onblur="checkthisPort(this)"/>
                                <input id="port_security_port_id" type="text" class="inputzk" style="display:none;" value="" />
                                <input id="port_security_port_protocol" type="text" class="inputzk" style="display:none;" value="" />
                            </div>
                            <div>
                                <span>协议：</span>
                                <select id="port_security_seclet" name="port_security_type" class="select">
                                    <option id="port_security_fiport_security_le" selected="selected" value="TCP">TCP</option>
                                    <option id="port_security_udp"  value="UDP">UDP</option>
                                    <option id="port_security_icmp"  value="ICMP">ICMP</option>
                                    <option id="port_security_ifmp"  value="IGMP">IGMP</option>
                                    <option id="port_security_ip"  value="IP">IP</option>
                                    <option id="port_security_rdp"  value="RDP">RDP</option>
                                    <option id="port_security_all"  value="ALL">ALL</option>
                                </select>
                            </div>
                            <div style="padding-bottom: 10px;">
                                <span>规则：</span>
                                <select id="port_security_rule_seclet" name="port_security_type" class="select">
                                    <option id="port_security_deny" selected="selected" value="port_security_denyall">所有IP一律拒绝</option>
                                    <option id="port_security_accept" value="port_security_acceptall">所有IP一律接受</option>
                                </select>
                            </div>
                            <table id="tbipsegment">
                                <tr/>
                            </table>
                            <div style="padding-top:5px;">
                                <p style="font-size:15px;color:unset;width: 79px;float: left;">单独IP：</p>
                                <textarea id="singleip" maxlength="150" style="width: 340px;height: 130px; margin-left: -5px;" placeholder="输入例外IP地址，多个地址用英文分号隔开" onblur="this.value=this.value.replace(/[^0-9.;]/,'');" onblur='checkthisExceptIP(this);'></textarea>
                            </div>
                            <div style="margin-top: 5px;margin-bottom: 10px;height: 25px;text-align: right;width: 95%;">
                            <button id="port_security_addrulebtn" onclick="saveposrtsecurity();" style="width:75px;">保存</button>
                        </div>
                        </div>
                    </div>
                    
                    
                </div>                                   
            </div>
        </div>  
    </div>
    
{% endblock %}
